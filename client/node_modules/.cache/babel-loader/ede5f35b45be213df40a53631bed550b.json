{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useRef,useCallback}from'react';import SiderLeftProfile from'./SiderLeftProfile.jsx';import SiderRightProfile from'./SiderRightProfile.jsx';import{Post}from'./Post.jsx';import{Row,Col}from'antd';import CreatePost from'./CreatePost.jsx';import{useSelector,useDispatch}from'react-redux';import axios from'axios';import{requestAddPostsProfile}from'./../../../Actions/index.jsx';import{responseAddPostsProfile}from'./../../../Actions/index.jsx';import{setCurrentPageProfile}from'./../../../Actions/index.jsx';import{skeletonPostNewFeed}from'./../../Skeleton/index.jsx';import{PUBLIC_URL}from'./../../../Constants/public.jsx';import{useParams}from'react-router-dom';function TimeLine(props,_ref){var myPosts=_ref.myPosts,profile=_ref.profile;var observer=useRef();var _useSelector=useSelector(function(state){return state.myPosts;}),listPosts=_useSelector.listPosts,loading=_useSelector.loading,error=_useSelector.error,hasMore=_useSelector.hasMore,loadingAddComment=_useSelector.loadingAddComment,loadingAddPost=_useSelector.loadingAddPost;var _useSelector2=useSelector(function(state){return state.profile;}),info=_useSelector2.info;var dispatch=useDispatch();var _useState=useState(),_useState2=_slicedToArray(_useState,2),statusCreatePost=_useState2[0],setStatusCreatePost=_useState2[1];var _useParams=useParams(),idProfile=_useParams.idProfile;var lastNewFeed=useCallback(function(node){if(loading)return;if(observer.current)observer.current.disconnect();observer.current=new IntersectionObserver(function(entries){if(entries[0].isIntersecting&&hasMore){dispatch(setCurrentPageProfile());}});if(node)observer.current.observe(node);},[loading,hasMore]);var submitCreatePost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(valueEditor,fileList,privacyNewFeed,privacyStory,placeNewFeed,placeStory,listMention){var mention,tags,tag,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(requestAddPostsProfile());setStatusCreatePost('loading');mention=[];listMention.map(function(m){mention.push(m.data.mention.id);});tags=mention.filter(function(value,index,mention){return mention.indexOf(value)===index;});tag=tags.toString();data={placeStory:placeStory,placePost:placeNewFeed,post_Content:valueEditor,post_Privacy:privacyNewFeed,tag_users_UserId:tag,story_Privacy:privacyStory,post_images_Url:fileList,post_userReceiveId:info.id};_context.next=9;return axios.post('https://www.api.mohi.vn/api/auth/create-post-profile',data).then(function(res){dispatch(responseAddPostsProfile(res.data.newPost));setStatusCreatePost('success');}).catch(function(e){setStatusCreatePost('error');});case 9:case\"end\":return _context.stop();}}},_callee);}));return function submitCreatePost(_x,_x2,_x3,_x4,_x5,_x6,_x7){return _ref2.apply(this,arguments);};}();var NoPost=function NoPost(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"new-feed-empty content-hello\"},/*#__PURE__*/React.createElement(\"p\",null,\"Mohi\"),/*#__PURE__*/React.createElement(\"img\",{src:PUBLIC_URL+\"images/nopost.jpg\",alt:\"B\\u1EA3ng tin kh\\xF4ng c\\xF3 b\\xE0i vi\\u1EBFt\"}),/*#__PURE__*/React.createElement(\"div\",{style:{color:'rgba(0,128,128)',fontSize:'15px',fontWeight:'600'}},\"H\\xE3y k\\u1EBFt b\\u1EA1n \\u0111\\u1EC3 nh\\u1EADn \\u0111\\u01B0\\u1EE3c nhi\\u1EC1u b\\xE0i vi\\u1EBFt h\\u01A1n t\\u1EEB b\\u1EA1n b\\xE8\")));};var sendReactionPost=function sendReactionPost(reaction,postId){props.sendReactionPost(reaction,postId);};var onSubmitComment=function onSubmitComment(value,idPost){props.onSubmitComment(value,idPost);};var loadingSendRequestSetting=function loadingSendRequestSetting(type,idPost,idUser){props.loadingSendRequestSetting(type,idPost,idUser);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(SiderLeftProfile,null),/*#__PURE__*/React.createElement(Col,{span:12,style:{padding:'0 10px'}},/*#__PURE__*/React.createElement(CreatePost,{submitCreatePost:submitCreatePost,statusCreatePost:statusCreatePost}),listPosts.map(function(post,index){return/*#__PURE__*/React.createElement(Post,{key:index,post:post,ref:lastNewFeed,sendReactionPost:sendReactionPost,onSubmitComment:onSubmitComment,loadingAddComment:loadingAddComment,loadingSendRequestSetting:loadingSendRequestSetting,loadingSetting:props.loadingSetting});}),loading&&skeletonPostNewFeed,!loading&&!listPosts.length&&/*#__PURE__*/React.createElement(NoPost,null),error&&/*#__PURE__*/React.createElement(\"div\",null,\"\\u0110\\xE3 x\\u1EA3y ra l\\u1ED7i kh\\xF4ng mong mu\\u1ED1n vui l\\xF2ng t\\u1EA3i l\\u1EA1i trang\")),/*#__PURE__*/React.createElement(SiderRightProfile,null)));}export default TimeLine;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/Profiles/MyProfile/TimeLine.jsx"],"names":["React","useState","useRef","useCallback","SiderLeftProfile","SiderRightProfile","Post","Row","Col","CreatePost","useSelector","useDispatch","axios","requestAddPostsProfile","responseAddPostsProfile","setCurrentPageProfile","skeletonPostNewFeed","PUBLIC_URL","useParams","TimeLine","props","myPosts","profile","observer","state","listPosts","loading","error","hasMore","loadingAddComment","loadingAddPost","info","dispatch","statusCreatePost","setStatusCreatePost","idProfile","lastNewFeed","node","current","disconnect","IntersectionObserver","entries","isIntersecting","observe","submitCreatePost","valueEditor","fileList","privacyNewFeed","privacyStory","placeNewFeed","placeStory","listMention","mention","map","m","push","data","id","tags","filter","value","index","indexOf","tag","toString","placePost","post_Content","post_Privacy","tag_users_UserId","story_Privacy","post_images_Url","post_userReceiveId","post","then","res","newPost","catch","e","NoPost","color","fontSize","fontWeight","sendReactionPost","reaction","postId","onSubmitComment","idPost","loadingSendRequestSetting","type","idUser","padding","loadingSetting","length"],"mappings":"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","sourcesContent":["import React, {useState, useRef, useCallback} from 'react';\r\nimport SiderLeftProfile from './SiderLeftProfile.jsx';\r\nimport SiderRightProfile from './SiderRightProfile.jsx';\r\nimport {Post} from './Post.jsx';\r\nimport { Row, Col } from 'antd';\r\nimport CreatePost from './CreatePost.jsx';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport axios from 'axios';\r\nimport { requestAddPostsProfile } from './../../../Actions/index.jsx';\r\nimport { responseAddPostsProfile } from './../../../Actions/index.jsx';\r\nimport { setCurrentPageProfile } from './../../../Actions/index.jsx';\r\nimport {skeletonPostNewFeed} from './../../Skeleton/index.jsx';\r\nimport {PUBLIC_URL} from './../../../Constants/public.jsx';\r\nimport {useParams} from 'react-router-dom';\r\n\r\nfunction TimeLine(props, { myPosts, profile }) {\r\n  const observer = useRef();\r\n  const { listPosts, loading, error, hasMore, loadingAddComment, loadingAddPost } = useSelector(state => state.myPosts);\r\n  const { info } = useSelector(state => state.profile);\r\n  const dispatch = useDispatch();\r\n  const [statusCreatePost, setStatusCreatePost] = useState();\r\n  const {idProfile} = useParams();\r\n\r\n  const lastNewFeed = useCallback(node => {\r\n    if(loading) return\r\n      if(observer.current) observer.current.disconnect()\r\n      observer.current = new IntersectionObserver(entries => {\r\n        if(entries[0].isIntersecting && hasMore){\r\n          dispatch(setCurrentPageProfile())\r\n        }\r\n      })\r\n    if(node) observer.current.observe(node)\r\n  }, [loading, hasMore])\r\n\r\n  const submitCreatePost = async (valueEditor, fileList, privacyNewFeed, privacyStory, placeNewFeed, placeStory, listMention) => {\r\n    dispatch(requestAddPostsProfile())\r\n    setStatusCreatePost('loading')\r\n\r\n    let mention = [];\r\n    listMention.map(m => {\r\n      mention.push(m.data.mention.id)\r\n    })\r\n    let tags = mention.filter((value, index, mention) => mention.indexOf(value) === index);\r\n    let tag = tags.toString();\r\n\r\n    let data = {\r\n        placeStory: placeStory,\r\n        placePost: placeNewFeed,\r\n        post_Content: valueEditor,\r\n        post_Privacy: privacyNewFeed,\r\n        tag_users_UserId: tag,\r\n        story_Privacy: privacyStory,\r\n        post_images_Url: fileList,\r\n        post_userReceiveId: info.id\r\n      }\r\n\r\n\r\n\r\n    await axios.post('https://www.api.mohi.vn/api/auth/create-post-profile', data).then((res) => {\r\n      dispatch(responseAddPostsProfile(res.data.newPost))\r\n      setStatusCreatePost('success')\r\n    }).catch((e) => {\r\n      setStatusCreatePost('error')\r\n    })\r\n\r\n  }\r\n\r\n  const NoPost = () => {\r\n      return(\r\n        <React.Fragment>\r\n          <div className=\"new-feed-empty content-hello\">\r\n            <p>Mohi</p>\r\n            <img src={PUBLIC_URL + `images/nopost.jpg`} alt=\"Bảng tin không có bài viết\" />\r\n          <div style={{color: 'rgba(0,128,128)', fontSize: '15px', fontWeight: '600'}}>Hãy kết bạn để nhận được nhiều bài viết hơn từ bạn bè</div>\r\n          </div>\r\n        </React.Fragment>\r\n      )\r\n  }\r\n\r\n  const sendReactionPost = (reaction, postId) => {\r\n    props.sendReactionPost(reaction, postId)\r\n  }\r\n\r\n  const onSubmitComment = (value, idPost) => {\r\n    props.onSubmitComment(value, idPost)\r\n  }\r\n\r\n  const loadingSendRequestSetting = (type, idPost, idUser) => {\r\n    props.loadingSendRequestSetting(type, idPost, idUser)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row>\r\n        <SiderLeftProfile />\r\n        <Col span={12} style={{ padding: '0 10px' }}>\r\n          <CreatePost submitCreatePost={submitCreatePost} statusCreatePost={statusCreatePost}/>\r\n          {listPosts.map((post, index) => <Post key={index} post={post} ref={lastNewFeed} sendReactionPost={sendReactionPost} onSubmitComment={onSubmitComment} loadingAddComment={loadingAddComment} loadingSendRequestSetting={loadingSendRequestSetting} loadingSetting={props.loadingSetting}/>)}\r\n          {loading && skeletonPostNewFeed}\r\n          {!loading && !listPosts.length  && <NoPost/>}\r\n          {error && <div>Đã xảy ra lỗi không mong muốn vui lòng tải lại trang</div>}\r\n        </Col>\r\n        <SiderRightProfile />\r\n      </Row>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default TimeLine;\r\n"]},"metadata":{},"sourceType":"module"}