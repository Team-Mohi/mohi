{"ast":null,"code":"var _jsxFileName = \"D:\\\\Web\\\\mohi\\\\client\\\\src\\\\app\\\\Authen\\\\VeriChangePass.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { RiErrorWarningLine } from \"react-icons/ri\";\nimport { Tooltip } from 'antd';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport { toggleStatusSpin } from './../../Actions/index.jsx';\nimport { useCookies } from \"react-cookie\";\n\nfunction VeriChangePass(props) {\n  const history = useHistory();\n\n  if (!history.location.state) {\n    history.push('/');\n  }\n\n  const [cookies, setCookie] = useCookies([\"vrct\"]);\n  const dispatch = useDispatch();\n  const avatar = history.location.state ? history.location.state.user_avatar : '';\n  const name = history.location.state ? history.location.state.user_name : '';\n  const code = history.location.state ? history.location.state.code : '';\n  const email = history.location.state ? history.location.state.user_email : '';\n  const idUser = history.location.state ? history.location.state.id_user : '';\n  const {\n    register,\n    handleSubmit,\n    errors,\n    setError\n  } = useForm();\n  const [errorEmailAndPhone, setErrorEmailAndPhone] = useState('Vui lòng nhập mã gồm 6 số');\n  const now = new Date().getTime();\n  useEffect(() => {\n    if (code) {\n      const timeExpiredCode = now + 300000;\n      setCookie(\"vrct\", timeExpiredCode, {\n        path: \"/\"\n      });\n    }\n  }, [code]);\n\n  const onSubmit = data => {\n    //load Spin\n    dispatch(toggleStatusSpin());\n\n    if (code === Number(data.code_change_pass)) {\n      if (cookies.vrct - new Date().getTime() > 0) {\n        history.push('/change-password', {\n          idUser: idUser,\n          user_email: email\n        });\n      } else {\n        setError(\"code_change_pass\", {\n          type: \"manual\",\n          message: \"Mã xác nhận đã hết hạn\"\n        });\n        setErrorEmailAndPhone('Mã xác nhận đã hết hạn');\n      }\n    } else {\n      setError(\"code_change_pass\", {\n        type: \"manual\",\n        message: \"Mã xác nhận không khớp với mã chúng tôi đã gửi\"\n      });\n      setErrorEmailAndPhone('Mã xác nhận không khớp với mã chúng tôi đã gửi');\n    } //close Spin\n\n\n    dispatch(toggleStatusSpin());\n  };\n\n  const validateInputCode = value => {\n    if (!value) return false;\n    if (!Number(value)) return false;\n    return true;\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"veri-code-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      marginBottom: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }, \"X\\xE1c nh\\u1EADn \\u0111\\u1ED5i m\\u1EADt kh\\u1EA9u\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"preview-info-user\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"preview-info-user-avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: avatar,\n    alt: name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"preview-info-user-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }, name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"veri-code-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: 'black'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, \"Ch\\xFAng t\\xF4i \\u0111\\xE3 g\\u1EEDi m\\xE3 x\\xE1c nh\\u1EADn \\u0111\\u1EBFn \"), email, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: 'black'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }, \" M\\xE3 n\\xE0y s\\u1EBD t\\u1ED3n t\\u1EA1i trong v\\xF2ng 5 ph\\xFAt. Vui l\\xF2ng ki\\u1EC3m tra v\\xE0 ho\\xE0n t\\u1EA5t qu\\xE1 tr\\xECnh \\u0111\\u1ED5i m\\u1EADt kh\\u1EA9u\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit-error-veri-code\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-veri-code-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"code_change_pass\",\n    placeholder: \"Nh\\u1EADp m\\xE3 g\\u1ED3m 6 s\\u1ED1\",\n    ref: register({\n      validate: value => validateInputCode(value)\n    }),\n    style: errors.code_change_pass ? {\n      border: '1px solid red'\n    } : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }), errors.code_change_pass && /*#__PURE__*/React.createElement(Tooltip, {\n    placement: \"right\",\n    title: /*#__PURE__*/React.createElement(\"p\", {\n      className: \"error_sex_tooltip\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 73\n      }\n    }, errorEmailAndPhone),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 39\n    }\n  }, /*#__PURE__*/React.createElement(RiErrorWarningLine, {\n    className: \"error_sex error_code\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 135\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-veri-code-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }, \"X\\xE1c nh\\u1EADn\")))));\n}\n\nexport default VeriChangePass;","map":{"version":3,"sources":["D:/Web/mohi/client/src/app/Authen/VeriChangePass.jsx"],"names":["React","useState","useEffect","useForm","RiErrorWarningLine","Tooltip","useHistory","useDispatch","toggleStatusSpin","useCookies","VeriChangePass","props","history","location","state","push","cookies","setCookie","dispatch","avatar","user_avatar","name","user_name","code","email","user_email","idUser","id_user","register","handleSubmit","errors","setError","errorEmailAndPhone","setErrorEmailAndPhone","now","Date","getTime","timeExpiredCode","path","onSubmit","data","Number","code_change_pass","vrct","type","message","validateInputCode","value","marginBottom","color","validate","border"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport {useForm} from 'react-hook-form';\r\nimport {RiErrorWarningLine} from \"react-icons/ri\";\r\nimport {Tooltip} from 'antd';\r\nimport {useHistory} from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { toggleStatusSpin } from './../../Actions/index.jsx';\r\nimport { useCookies } from \"react-cookie\";\r\n\r\nfunction VeriChangePass(props){\r\n  const history = useHistory();\r\n  if(!history.location.state){\r\n    history.push('/')\r\n  }\r\n  const [cookies, setCookie] = useCookies([\"vrct\"]);\r\n  const dispatch = useDispatch();\r\n  const avatar = history.location.state ? history.location.state.user_avatar : '';\r\n  const name = history.location.state ? history.location.state.user_name : '';\r\n  const code = history.location.state ? history.location.state.code : '';\r\n  const email = history.location.state ? history.location.state.user_email : '';\r\n  const idUser = history.location.state ? history.location.state.id_user : '';\r\n  const {register, handleSubmit, errors, setError} = useForm();\r\n  const [errorEmailAndPhone, setErrorEmailAndPhone] = useState('Vui lòng nhập mã gồm 6 số');\r\n  const now = new Date().getTime();\r\n\r\n  useEffect(() => {\r\n    if(code){\r\n      const timeExpiredCode = now + 300000;\r\n      setCookie(\"vrct\", timeExpiredCode, {\r\n        path: \"/\"\r\n      })\r\n    }\r\n  }, [code]);\r\n\r\n  const onSubmit = (data) => {\r\n    //load Spin\r\n    dispatch(toggleStatusSpin())\r\n\r\n    if(code === Number(data.code_change_pass)){\r\n      if(cookies.vrct - new Date().getTime() > 0){\r\n        history.push('/change-password',{idUser: idUser, user_email: email})\r\n      }else {\r\n        setError(\"code_change_pass\", {\r\n              type: \"manual\",\r\n              message: \"Mã xác nhận đã hết hạn\"\r\n            });\r\n        setErrorEmailAndPhone('Mã xác nhận đã hết hạn')\r\n      }\r\n    }else {\r\n      setError(\"code_change_pass\", {\r\n            type: \"manual\",\r\n            message: \"Mã xác nhận không khớp với mã chúng tôi đã gửi\"\r\n          });\r\n      setErrorEmailAndPhone('Mã xác nhận không khớp với mã chúng tôi đã gửi')\r\n    }\r\n\r\n    //close Spin\r\n    dispatch(toggleStatusSpin())\r\n  }\r\n\r\n  const validateInputCode = (value) => {\r\n    if(!value) return false\r\n    if(!Number(value)) return false\r\n\r\n    return true\r\n  }\r\n\r\n  return(\r\n    <React.Fragment>\r\n      <div className=\"veri-code-container\">\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <h2 style={{marginBottom: '20px'}}>Xác nhận đổi mật khẩu</h2>\r\n          <div className=\"preview-info-user\">\r\n            <div className=\"preview-info-user-avatar\">\r\n              <img src={avatar} alt={name} />\r\n            </div>\r\n            <div className=\"preview-info-user-name\">{name}</div>\r\n          </div>\r\n          <div className=\"veri-code-message\">\r\n            <span style={{color: 'black'}}>Chúng tôi đã gửi mã xác nhận đến </span>{email}\r\n            <span style={{color: 'black'}}> Mã này sẽ tồn tại trong vòng 5 phút. Vui lòng kiểm tra và hoàn tất quá trình đổi mật khẩu</span>\r\n          </div>\r\n          <div className=\"submit-error-veri-code\"></div>\r\n          <div className=\"form-veri-code-group\">\r\n            <input\r\n              type=\"text\"\r\n              name=\"code_change_pass\"\r\n              placeholder=\"Nhập mã gồm 6 số\"\r\n              ref={register({\r\n                  validate: value => validateInputCode(value)\r\n                })}\r\n              style={errors.code_change_pass ? {border: '1px solid red'} : null}\r\n            />\r\n          {errors.code_change_pass && <Tooltip placement=\"right\" title={<p className = \"error_sex_tooltip\" >{errorEmailAndPhone}</p>}><RiErrorWarningLine className=\"error_sex error_code\"/></Tooltip>}\r\n          </div>\r\n          <div className=\"form-veri-code-group\">\r\n            <button type=\"submit\">Xác nhận</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default VeriChangePass;\r\n"]},"metadata":{},"sourceType":"module"}