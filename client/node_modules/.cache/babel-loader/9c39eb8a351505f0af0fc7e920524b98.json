{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./Setting.css';import{FiSettings}from\"react-icons/fi\";import{MdSecurity}from\"react-icons/md\";import{TiInfoLarge}from\"react-icons/ti\";import{Link,Route,Switch,useLocation}from'react-router-dom';import{Descriptions,Collapse}from'antd';import{useForm}from\"react-hook-form\";import{responseUpdateProfile}from'./../../Actions/index.jsx';import{requestUpdateProfile}from'./../../Actions/index.jsx';import editInfo from'./../../axios/axiosEditInfoProfile.jsx';import{WaveLoading}from'react-loadingg';import{useDispatch}from'react-redux';import{requestInfoProfile}from'./../../Actions/index.jsx';import{responseInfoProfile}from'./../../Actions/index.jsx';import axios from'axios';import{RiErrorWarningLine}from\"react-icons/ri\";import{Tooltip}from'antd';var Panel=Collapse.Panel;var General=function General(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),styleInputAddContact=_useState2[0],setStyleInputAddContact=_useState2[1];var onSubmitUpdateName=function onSubmitUpdateName(data){props.onSubmitUpdateName(data);};var onSubmitUpdateUserName=function onSubmitUpdateUserName(data){props.onSubmitUpdateUserName(data);};return/*#__PURE__*/React.createElement(\"div\",{className:\"general-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"general-title\"},/*#__PURE__*/React.createElement(\"h5\",null,\" C\\xE0i \\u0111\\u1EB7t t\\xE0i kho\\u1EA3n chung\")),/*#__PURE__*/React.createElement(\"div\",{className:\"general-content\"},/*#__PURE__*/React.createElement(Collapse,{defaultActiveKey:['0'],accordion:true},/*#__PURE__*/React.createElement(Panel,{header:/*#__PURE__*/React.createElement(SettingGeneralName,{ustk:props.ustk}),key:\"1\"},/*#__PURE__*/React.createElement(PanelName,{onSubmitUpdateName:onSubmitUpdateName,loadingUpdateName:props.loadingUpdateName,ustk:props.ustk})),/*#__PURE__*/React.createElement(Panel,{header:/*#__PURE__*/React.createElement(SettingGeneralNameUser,{ustk:props.ustk}),key:\"2\"},/*#__PURE__*/React.createElement(PanelUserName,{erruserName:props.erruserName,onSubmitUpdateUserName:onSubmitUpdateUserName,loadingUpdateUsername:props.loadingUpdateUsername,ustk:props.ustk})))));};var PanelName=function PanelName(props){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,watch=_useForm.watch,errors=_useForm.errors;var onSubmit=function onSubmit(data){if(data.user_first_name!==props.ustk.user_first_name||data.user_last_name!==props.ustk.user_last_name){props.onSubmitUpdateName(data);}};return/*#__PURE__*/React.createElement(\"div\",{className:\"setting-general-name\"},/*#__PURE__*/React.createElement(\"b\",null,\"T\\xEAn c\\u1EE7a b\\u1EA1n s\\u1EBD thay \\u0111\\u1ED5i tr\\xEAn Mohi\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-name\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"H\\u1ECD\"),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-input\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",defaultValue:props.ustk.user_first_name,name:\"user_first_name\",ref:register({required:true}),style:errors.user_first_name?{border:'1px solid red'}:null}),errors.user_first_name&&/*#__PURE__*/React.createElement(Tooltip,{placement:\"bottom\",title:/*#__PURE__*/React.createElement(\"p\",{className:\"error_sex_tooltip\"},\" Vui l\\xF2ng nh\\u1EADp h\\u1ECD c\\u1EE7a b\\u1EA1n\")},/*#__PURE__*/React.createElement(RiErrorWarningLine,{className:\"error_sex err_setting\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-name\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"T\\xEAn\"),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-input\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",defaultValue:props.ustk.user_last_name,name:\"user_last_name\",ref:register({required:true}),style:errors.user_last_name?{border:'1px solid red'}:null}),errors.user_last_name&&/*#__PURE__*/React.createElement(Tooltip,{placement:\"bottom\",title:/*#__PURE__*/React.createElement(\"p\",{className:\"error_sex_tooltip\"},\" Vui l\\xF2ng nh\\u1EADp t\\xEAn c\\u1EE7a b\\u1EA1n\")},/*#__PURE__*/React.createElement(RiErrorWarningLine,{className:\"error_sex err_setting\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-name-button\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"X\\xE1c nh\\u1EADn thay \\u0111\\u1ED5i\"))),props.loadingUpdateName&&/*#__PURE__*/React.createElement(\"div\",{style:{background:'rgba(255,255,255,0.7)',position:'absolute',width:'100%',height:'100%',top:0,left:0}},/*#__PURE__*/React.createElement(WaveLoading,null)));};var PanelUserName=function PanelUserName(props){var _useForm2=useForm(),register=_useForm2.register,handleSubmit=_useForm2.handleSubmit,watch=_useForm2.watch,errors=_useForm2.errors,setError=_useForm2.setError;var _useState3=useState('Tên người dùng phải là chữ thường không dấu và không chứa kí tự đặc biệt'),_useState4=_slicedToArray(_useState3,2),errUserName=_useState4[0],setErruserName=_useState4[1];var _useState5=useState(props.ustk.user_username),_useState6=_slicedToArray(_useState5,2),valueUserName=_useState6[0],setValueUserName=_useState6[1];useEffect(function(){if(props.erruserName){setError(\"user_username\",{type:\"manual\",message:\"Tên người dùng đã tồn tại\"});setErruserName('Tên người dùng đã tồn tại');}},[props.erruserName]);var validateInputUserName=function validateInputUserName(value){/* lowcase character Test */if(value!==value.toLowerCase()){return false;}/* lowcase character Test */var filter1=/[ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ]/;if(filter1.test(value)){return false;}/* Special character Test */var filter=/[ !@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,<>\\/?]/;if(filter.test(value)){return false;}return true;};var onChange=function onChange(e){setValueUserName(e.target.value);};var onSubmit=function onSubmit(data){if(valueUserName!==props.ustk.user_username){props.onSubmitUpdateUserName({user_username:valueUserName});}};return/*#__PURE__*/React.createElement(\"div\",{className:\"setting-general-name\"},/*#__PURE__*/React.createElement(\"b\",null,\"T\\xEAn ng\\u01B0\\u1EDDi d\\xF9ng c\\xF4ng khai c\\u1EE7a b\\u1EA1n gi\\u1ED1ng v\\u1EDBi t\\xEAn trong \\u0111\\u1ECBa ch\\u1EC9 d\\xF2ng th\\u1EDDi gian c\\u1EE7a b\\u1EA1n\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-name\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"T\\xEAn ng\\u01B0\\u1EDDi d\\xF9ng\"),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-input\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",defaultValue:valueUserName,onChange:onChange,name:\"user_username\",ref:register({validate:function validate(value){return validateInputUserName(value);}}),style:errors.user_username?{border:'1px solid red'}:null}),errors.user_username&&/*#__PURE__*/React.createElement(Tooltip,{placement:\"bottom\",title:/*#__PURE__*/React.createElement(\"p\",{className:\"error_sex_tooltip\"},errUserName)},/*#__PURE__*/React.createElement(RiErrorWarningLine,{className:\"error_sex err_setting\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-name-button\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"X\\xE1c nh\\u1EADn thay \\u0111\\u1ED5i\"))),props.loadingUpdateUsername&&/*#__PURE__*/React.createElement(\"div\",{style:{background:'rgba(255,255,255,0.7)',position:'absolute',width:'100%',height:'100%',top:0,left:0}},/*#__PURE__*/React.createElement(WaveLoading,null)));};var SettingGeneralName=function SettingGeneralName(props){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Descriptions,{className:\"general-information\"},/*#__PURE__*/React.createElement(Descriptions.Item,{className:\"general-item\"},\"T\\xEAn\"),/*#__PURE__*/React.createElement(Descriptions.Item,null,/*#__PURE__*/React.createElement(\"p\",null,props.ustk.user_first_name+' '+props.ustk.user_last_name)),/*#__PURE__*/React.createElement(Descriptions.Item,{className:\"setting-general-button\"},/*#__PURE__*/React.createElement(\"button\",_defineProperty({type:\"submit\"},\"type\",\"info\"),\"Ch\\u1EC9nh s\\u1EEDa\")),/*#__PURE__*/React.createElement(SettingGeneralName,null)));};var SettingGeneralNameUser=function SettingGeneralNameUser(props){return/*#__PURE__*/React.createElement(Descriptions,{className:\"general-information\"},/*#__PURE__*/React.createElement(Descriptions.Item,{className:\"general-item\"},\"T\\xEAn ng\\u01B0\\u1EDDi d\\xF9ng\"),/*#__PURE__*/React.createElement(Descriptions.Item,null,\"https://www.mohi.vn/\",props.ustk.user_username),/*#__PURE__*/React.createElement(Descriptions.Item,{className:\"setting-general-button\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Ch\\u1EC9nh s\\u1EEDa\")));};var Password=function Password(props){var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openPopupChangePassword=_useState8[0],setOpenPopupChangePassword=_useState8[1];var openPopupChangePasswordFunc=function openPopupChangePasswordFunc(){setOpenPopupChangePassword(!openPopupChangePassword);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"general-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"general-title\"},/*#__PURE__*/React.createElement(\"h5\",null,\" \\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u\")),!openPopupChangePassword?/*#__PURE__*/React.createElement(\"div\",{className:\"setting-password\"},/*#__PURE__*/React.createElement(\"h6\",null,\" B\\u1EA1n n\\xEAn s\\u1EED d\\u1EE5ng m\\u1EADt kh\\u1EA9u m\\u1EA1nh m\\xE0 m\\xECnh ch\\u01B0a s\\u1EED d\\u1EE5ng \\u1EDF \\u0111\\xE2u kh\\xE1c\"),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-password\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"M\\u1EADt kh\\u1EA9u hi\\u1EC7n t\\u1EA1i\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-password\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"M\\u1EADt kh\\u1EA9u m\\u1EDBi\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-password\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"Nh\\u1EADp l\\u1EA1i m\\u1EADt kh\\u1EA9u m\\u1EDBi\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-password\"},/*#__PURE__*/React.createElement(\"div\",{className:\"setting-general-add-email-click\",onClick:openPopupChangePasswordFunc},\"Qu\\xEAn m\\u1EADt kh\\u1EA9u?\")),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-edit-name-button\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"X\\xE1c nh\\u1EADn thay \\u0111\\u1ED5i\"),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"H\\u1EE7y\")))):/*#__PURE__*/React.createElement(\"div\",{className:\"setting-password\"},/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-change-password\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"Nh\\u1EADp email ho\\u1EB7c s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i \\u0111\\u1EC3 l\\u1EA5y l\\u1EA1i m\\u1EADt kh\\u1EA9u\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Nh\\u1EADp email ho\\u1EB7c s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i...\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-form-change-password-button\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"G\\u1EEDi\"),/*#__PURE__*/React.createElement(\"button\",{onClick:openPopupChangePasswordFunc},\"Quay l\\u1EA1i\"))))));};function Setting(){var path=useLocation().pathname.split('/');var isActive=path[2];var _useState9=useState(JSON.parse(localStorage.getItem('ustk')).info),_useState10=_slicedToArray(_useState9,2),ustk=_useState10[0],setUstk=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loadingUpdateUsername=_useState12[0],setLoadingUpdateUsername=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),loadingUpdateName=_useState14[0],setLoadingUpdateName=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),erruserName=_useState16[0],setErruserName=_useState16[1];var dispatch=useDispatch();useEffect(function(){fetchInfoProfile();},[]);var fetchInfoProfile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(requestInfoProfile());_context.next=3;return axios.get('https://www.api.mohi.vn/api/auth/get-info-profile/'+ustk.user_username).then(function(res){dispatch(responseInfoProfile(res.data));}).catch(function(e){dispatch(responseInfoProfile(''));});case 3:case\"end\":return _context.stop();}}},_callee);}));return function fetchInfoProfile(){return _ref.apply(this,arguments);};}();var onSubmitUpdateUserName=function onSubmitUpdateUserName(data){dispatch(requestUpdateProfile());setLoadingUpdateUsername(true);editInfo({type:'user_username',value:data.user_username}).then(function(res){var newUstk=JSON.parse(localStorage.getItem('ustk'));newUstk.info.user_username=data.user_username;localStorage.setItem('ustk',JSON.stringify(newUstk));setUstk(JSON.parse(localStorage.getItem('ustk')).info);dispatch(responseUpdateProfile({type:'user_username',value:data.user_username}));setLoadingUpdateUsername(false);setErruserName();}).catch(function(e){if(e.response.status===400){setLoadingUpdateUsername(false);setErruserName(Math.random());}});};var onSubmitUpdateName=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(requestUpdateProfile());setLoadingUpdateName(true);_context2.next=4;return axios.post('https://www.api.mohi.vn/api/auth/update-info-profile',{user_first_name:data.user_first_name,user_last_name:data.user_last_name}).then(function(res){var newUstk=JSON.parse(localStorage.getItem('ustk'));newUstk.info.user_first_name=data.user_first_name;newUstk.info.user_last_name=data.user_last_name;localStorage.setItem('ustk',JSON.stringify(newUstk));setUstk(JSON.parse(localStorage.getItem('ustk')).info);dispatch(responseUpdateProfile({type:'user_first_name',value:data.user_last_name}));dispatch(responseUpdateProfile({type:'user_last_name',value:data.user_last_name}));setLoadingUpdateName(false);});case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmitUpdateName(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"setting-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"setting-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"setting-content-left\"},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(Link,{to:\"/setting/general\"},/*#__PURE__*/React.createElement(\"li\",{className:isActive==='general'||!isActive?'active':''},/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(FiSettings,null),\" C\\xE0i \\u0111\\u1EB7t chung\"))),/*#__PURE__*/React.createElement(Link,{to:\"/setting/password\"},/*#__PURE__*/React.createElement(\"li\",{className:isActive==='password'?'active':''},/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(MdSecurity,null),\" \\u0110\\u1ED5i m\\u1EADt kh\\u1EA9u\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"setting-content-right\"},/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{path:\"/setting/general\"},/*#__PURE__*/React.createElement(General,{ustk:ustk,erruserName:erruserName,onSubmitUpdateName:onSubmitUpdateName,onSubmitUpdateUserName:onSubmitUpdateUserName,loadingUpdateUsername:loadingUpdateUsername,loadingUpdateName:loadingUpdateName})),/*#__PURE__*/React.createElement(Route,{path:\"/setting/password\"},/*#__PURE__*/React.createElement(Password,{ustk:ustk})),/*#__PURE__*/React.createElement(Route,{component:General},/*#__PURE__*/React.createElement(General,{ustk:ustk,erruserName:erruserName,onSubmitUpdateName:onSubmitUpdateName,onSubmitUpdateUserName:onSubmitUpdateUserName,loadingUpdateUsername:loadingUpdateUsername,loadingUpdateName:loadingUpdateName}))))));}export default Setting;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/Setting/Setting.jsx"],"names":["React","useState","useEffect","FiSettings","MdSecurity","TiInfoLarge","Link","Route","Switch","useLocation","Descriptions","Collapse","useForm","responseUpdateProfile","requestUpdateProfile","editInfo","WaveLoading","useDispatch","requestInfoProfile","responseInfoProfile","axios","RiErrorWarningLine","Tooltip","Panel","General","props","styleInputAddContact","setStyleInputAddContact","onSubmitUpdateName","data","onSubmitUpdateUserName","ustk","loadingUpdateName","erruserName","loadingUpdateUsername","PanelName","register","handleSubmit","watch","errors","onSubmit","user_first_name","user_last_name","required","border","background","position","width","height","top","left","PanelUserName","setError","errUserName","setErruserName","user_username","valueUserName","setValueUserName","type","message","validateInputUserName","value","toLowerCase","filter1","test","filter","onChange","e","target","validate","SettingGeneralName","SettingGeneralNameUser","Password","openPopupChangePassword","setOpenPopupChangePassword","openPopupChangePasswordFunc","Setting","path","pathname","split","isActive","JSON","parse","localStorage","getItem","info","setUstk","setLoadingUpdateUsername","setLoadingUpdateName","dispatch","fetchInfoProfile","get","then","res","catch","newUstk","setItem","stringify","response","status","Math","random","post"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Setting.css';\r\nimport { FiSettings } from \"react-icons/fi\";\r\nimport { MdSecurity } from \"react-icons/md\";\r\nimport { TiInfoLarge } from \"react-icons/ti\";\r\nimport { Link, Route, Switch, useLocation } from 'react-router-dom';\r\nimport { Descriptions, Collapse } from 'antd';\r\nimport { useForm } from \"react-hook-form\";\r\nimport { responseUpdateProfile } from './../../Actions/index.jsx';\r\nimport { requestUpdateProfile } from './../../Actions/index.jsx';\r\nimport editInfo from './../../axios/axiosEditInfoProfile.jsx';\r\nimport { WaveLoading } from 'react-loadingg';\r\nimport { useDispatch } from 'react-redux';\r\nimport { requestInfoProfile } from './../../Actions/index.jsx';\r\nimport { responseInfoProfile } from './../../Actions/index.jsx';\r\nimport axios from 'axios';\r\nimport {RiErrorWarningLine} from \"react-icons/ri\";\r\nimport {Tooltip} from 'antd';\r\n\r\nconst { Panel } = Collapse;\r\n\r\nconst General = (props) => {\r\n  const [styleInputAddContact, setStyleInputAddContact] = useState();\r\n\r\n  const onSubmitUpdateName = (data) => {\r\n    props.onSubmitUpdateName(data)\r\n  }\r\n\r\n  const onSubmitUpdateUserName = (data) => {\r\n    props.onSubmitUpdateUserName(data)\r\n  }\r\n\r\n  return (\r\n    <div className=\"general-container\">\r\n      <div className=\"general-title\">\r\n        <h5> Cài đặt tài khoản chung</h5>\r\n      </div>\r\n      <div className=\"general-content\">\r\n        <Collapse defaultActiveKey={['0']} accordion>\r\n          <Panel header={<SettingGeneralName ustk={props.ustk}/>} key=\"1\">\r\n            <PanelName onSubmitUpdateName={onSubmitUpdateName} loadingUpdateName={props.loadingUpdateName} ustk={props.ustk}/>\r\n          </Panel>\r\n          <Panel header={<SettingGeneralNameUser ustk={props.ustk}/>} key=\"2\">\r\n            <PanelUserName erruserName={props.erruserName} onSubmitUpdateUserName={onSubmitUpdateUserName} loadingUpdateUsername={props.loadingUpdateUsername} ustk={props.ustk}/>\r\n          </Panel>\r\n      </Collapse>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst PanelName = (props) => {\r\n  const { register, handleSubmit, watch, errors } = useForm();\r\n\r\n  const onSubmit = (data) => {\r\n    if(data.user_first_name !== props.ustk.user_first_name || data.user_last_name !== props.ustk.user_last_name){\r\n      props.onSubmitUpdateName(data)\r\n    }\r\n  }\r\n  return(\r\n      <div className=\"setting-general-name\">\r\n        <b>Tên của bạn sẽ thay đổi trên Mohi</b>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div className=\"setting-form-edit-name\">\r\n            <label htmlFor=\"\">Họ</label>\r\n            <div className=\"setting-form-input\">\r\n            <input type=\"text\" defaultValue={props.ustk.user_first_name }  name=\"user_first_name\" ref={register({required: true})} style={errors.user_first_name\r\n                ? {\r\n                  border: '1px solid red'\r\n                }\r\n                : null}/>\r\n              {errors.user_first_name && <Tooltip placement=\"bottom\" title={<p className = \"error_sex_tooltip\" > Vui lòng nhập họ của bạn</p>}><RiErrorWarningLine className=\"error_sex err_setting\"/></Tooltip>}\r\n            </div>\r\n          </div>\r\n          <div className=\"setting-form-edit-name\">\r\n            <label htmlFor=\"\">Tên</label>\r\n            <div className=\"setting-form-input\">\r\n            <input type=\"text\" defaultValue={props.ustk.user_last_name } name=\"user_last_name\" ref={register({required: true})} style={errors.user_last_name\r\n                ? {\r\n                  border: '1px solid red'\r\n                }\r\n                : null}/>\r\n              {errors.user_last_name && <Tooltip placement=\"bottom\" title={<p className = \"error_sex_tooltip\" > Vui lòng nhập tên của bạn</p>}><RiErrorWarningLine className=\"error_sex err_setting\"/></Tooltip>}\r\n            </div>\r\n          </div>\r\n          <div className=\"setting-form-edit-name-button\">\r\n            <button type=\"submit\">Xác nhận thay đổi</button>\r\n          </div>\r\n        </form>\r\n        { props.loadingUpdateName && <div style={{background: 'rgba(255,255,255,0.7)', position: 'absolute', width: '100%', height: '100%', top: 0, left: 0}}><WaveLoading /></div>}\r\n      </div>\r\n  )\r\n}\r\n\r\nconst PanelUserName = (props) => {\r\n  const { register, handleSubmit, watch, errors, setError } = useForm();\r\n  const [errUserName, setErruserName] = useState('Tên người dùng phải là chữ thường không dấu và không chứa kí tự đặc biệt');\r\n  const [valueUserName, setValueUserName] = useState(props.ustk.user_username);\r\n\r\n  useEffect(() => {\r\n    if(props.erruserName){\r\n      setError(\"user_username\", {\r\n            type: \"manual\",\r\n            message: \"Tên người dùng đã tồn tại\"\r\n      });\r\n      setErruserName('Tên người dùng đã tồn tại')\r\n    }\r\n  }, [props.erruserName])\r\n\r\n  const validateInputUserName = (value) => {\r\n    /* lowcase character Test */\r\n    if (value !== value.toLowerCase()) {\r\n      return false;\r\n    }\r\n\r\n    /* lowcase character Test */\r\n    var filter1 = /[ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ]/;\r\n    if (filter1.test(value)) {\r\n      return false;\r\n    }\r\n    /* Special character Test */\r\n    var filter = /[ !@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,<>\\/?]/;\r\n    if (filter.test(value)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  const onChange = (e) => {\r\n    setValueUserName(e.target.value)\r\n  }\r\n\r\n  const onSubmit = (data) => {\r\n    if(valueUserName !== props.ustk.user_username ){\r\n      props.onSubmitUpdateUserName({user_username: valueUserName})\r\n    }\r\n  }\r\n  return(\r\n      <div className=\"setting-general-name\">\r\n        <b>Tên người dùng công khai của bạn giống với tên trong địa chỉ dòng thời gian của bạn</b>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div className=\"setting-form-edit-name\">\r\n            <label htmlFor=\"\">Tên người dùng</label>\r\n            <div className=\"setting-form-input\">\r\n              <input type=\"text\" defaultValue={valueUserName} onChange={onChange} name=\"user_username\" ref={register({\r\n                  validate: value => validateInputUserName(value)\r\n                })} style={errors.user_username\r\n                ? {\r\n                  border: '1px solid red'\r\n                }\r\n                : null}/>\r\n              {errors.user_username && <Tooltip placement=\"bottom\" title={<p className = \"error_sex_tooltip\" >{errUserName}</p>}><RiErrorWarningLine className=\"error_sex err_setting\"/></Tooltip>}\r\n            </div>\r\n          </div>\r\n          <div className=\"setting-form-edit-name-button\">\r\n            <button type=\"submit\">Xác nhận thay đổi</button>\r\n          </div>\r\n        </form>\r\n        { props.loadingUpdateUsername && <div style={{background: 'rgba(255,255,255,0.7)', position: 'absolute', width: '100%', height: '100%', top: 0, left: 0}}><WaveLoading /></div>}\r\n      </div>\r\n  )\r\n}\r\nconst SettingGeneralName = (props) => {\r\n  return (\r\n    <>\r\n      <Descriptions className=\"general-information\">\r\n        <Descriptions.Item className=\"general-item\">Tên</Descriptions.Item>\r\n        <Descriptions.Item >\r\n        <p>{props.ustk.user_first_name + ' ' + props.ustk.user_last_name}</p>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item className=\"setting-general-button\">\r\n          <button type=\"submit\" type=\"info\">Chỉnh sửa</button>\r\n        </Descriptions.Item>\r\n        <SettingGeneralName />\r\n      </Descriptions>\r\n    </>\r\n  );\r\n}\r\n\r\nconst SettingGeneralNameUser = (props) => {\r\n  return (\r\n    <Descriptions className=\"general-information\">\r\n      <Descriptions.Item className=\"general-item\">Tên người dùng</Descriptions.Item>\r\n      <Descriptions.Item>\r\n        https://www.mohi.vn/{props.ustk.user_username}\r\n          </Descriptions.Item>\r\n      <Descriptions.Item className=\"setting-general-button\">\r\n        <button type=\"submit\">Chỉnh sửa</button>\r\n      </Descriptions.Item>\r\n    </Descriptions>\r\n  );\r\n}\r\n\r\nconst Password = (props) => {\r\n\r\n  const [openPopupChangePassword, setOpenPopupChangePassword] = useState(false);\r\n\r\n  const openPopupChangePasswordFunc = () => {\r\n    setOpenPopupChangePassword(!openPopupChangePassword)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"general-container\">\r\n        <div className=\"general-title\">\r\n          <h5> Đổi mật khẩu</h5>\r\n        </div>\r\n        {!openPopupChangePassword ?\r\n        <div className=\"setting-password\">\r\n          <h6>\tBạn nên sử dụng mật khẩu mạnh mà mình chưa sử dụng ở đâu khác</h6>\r\n          <form >\r\n            <div className=\"setting-form-edit-password\">\r\n              <label htmlFor=\"\">Mật khẩu hiện tại</label>\r\n              <input type=\"password\" />\r\n            </div>\r\n            <div className=\"setting-form-edit-password\">\r\n              <label htmlFor=\"\">Mật khẩu mới</label>\r\n              <input type=\"password\" />\r\n            </div>\r\n            <div className=\"setting-form-edit-password\">\r\n              <label htmlFor=\"\">Nhập lại mật khẩu mới</label>\r\n              <input type=\"password\" />\r\n            </div>\r\n            <div className=\"setting-form-edit-password\">\r\n              <div className=\"setting-general-add-email-click\" onClick={openPopupChangePasswordFunc}>Quên mật khẩu?</div>\r\n            </div>\r\n            <div className=\"setting-form-edit-name-button\">\r\n              <button type=\"submit\">Xác nhận thay đổi</button>\r\n              <button type=\"submit\">Hủy</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n        :\r\n        <div className=\"setting-password\">\r\n          <form>\r\n          <div className=\"setting-form-change-password\">\r\n            <label htmlFor=\"\">Nhập email hoặc số điện thoại để lấy lại mật khẩu</label>\r\n            <input type=\"text\" placeholder=\"Nhập email hoặc số điện thoại...\" />\r\n          </div>\r\n          <div className=\"setting-form-change-password-button\">\r\n              <button type=\"submit\">Gửi</button>\r\n              <button onClick={openPopupChangePasswordFunc}>Quay lại</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n      }\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Setting() {\r\n  const path = useLocation().pathname.split('/');\r\n  const isActive = path[2];\r\n  const [ustk, setUstk] =  useState(JSON.parse(localStorage.getItem('ustk')).info);\r\n  const [loadingUpdateUsername, setLoadingUpdateUsername] =  useState(false);\r\n  const [loadingUpdateName, setLoadingUpdateName] =  useState(false);\r\n  const [erruserName, setErruserName] =  useState();\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n      fetchInfoProfile()\r\n  }, [])\r\n\r\n  const fetchInfoProfile = async () => {\r\n    dispatch(requestInfoProfile())\r\n\r\n    await axios.get('https://www.api.mohi.vn/api/auth/get-info-profile/'+ ustk.user_username)\r\n    .then((res) => {\r\n      dispatch(responseInfoProfile(res.data))\r\n    })\r\n    .catch((e) => {\r\n      dispatch(responseInfoProfile(''))\r\n    })\r\n  }\r\n\r\n  const onSubmitUpdateUserName = (data) => {\r\n      dispatch(requestUpdateProfile())\r\n      setLoadingUpdateUsername(true)\r\n      editInfo({type: 'user_username', value: data.user_username})\r\n      .then((res) => {\r\n        let newUstk = JSON.parse(localStorage.getItem('ustk'));\r\n        newUstk.info.user_username = data.user_username;\r\n        localStorage.setItem('ustk', JSON.stringify(newUstk));\r\n        setUstk(JSON.parse(localStorage.getItem('ustk')).info)\r\n        dispatch(responseUpdateProfile({type: 'user_username', value: data.user_username}))\r\n        setLoadingUpdateUsername(false)\r\n        setErruserName()\r\n      })\r\n      .catch((e) => {\r\n        if(e.response.status === 400){\r\n          setLoadingUpdateUsername(false)\r\n          setErruserName(Math.random())\r\n        }\r\n      })\r\n  }\r\n\r\n  const onSubmitUpdateName = async (data) => {\r\n    dispatch(requestUpdateProfile())\r\n    setLoadingUpdateName(true)\r\n\r\n    await axios.post('https://www.api.mohi.vn/api/auth/update-info-profile', {user_first_name: data.user_first_name, user_last_name: data.user_last_name})\r\n    .then(res => {\r\n      let newUstk = JSON.parse(localStorage.getItem('ustk'));\r\n      newUstk.info.user_first_name = data.user_first_name;\r\n      newUstk.info.user_last_name = data.user_last_name;\r\n      localStorage.setItem('ustk', JSON.stringify(newUstk));\r\n      setUstk(JSON.parse(localStorage.getItem('ustk')).info)\r\n      dispatch(responseUpdateProfile({type: 'user_first_name', value: data.user_last_name}))\r\n      dispatch(responseUpdateProfile({type: 'user_last_name', value: data.user_last_name}))\r\n      setLoadingUpdateName(false)\r\n    })\r\n\r\n  }\r\n  return (\r\n      <div className=\"setting-container\">\r\n        <div className=\"setting-content\">\r\n          <div className=\"setting-content-left\">\r\n            <ul>\r\n              <Link to=\"/setting/general\">\r\n                <li className={isActive === 'general' || !isActive ? 'active' : ''}>\r\n                  <span><FiSettings /> Cài đặt chung</span>\r\n                </li>\r\n              </Link>\r\n              <Link to=\"/setting/password\">\r\n                <li className={isActive === 'password' ? 'active' : ''}>\r\n                  <span><MdSecurity /> Đổi mật khẩu</span>\r\n                </li>\r\n              </Link>\r\n            </ul>\r\n          </div>\r\n          <div className=\"setting-content-right\">\r\n            <Switch>\r\n              <Route path=\"/setting/general\">\r\n                <General ustk={ustk} erruserName={erruserName} onSubmitUpdateName={onSubmitUpdateName} onSubmitUpdateUserName={onSubmitUpdateUserName} loadingUpdateUsername={loadingUpdateUsername} loadingUpdateName={loadingUpdateName}/>\r\n              </Route>\r\n              <Route path=\"/setting/password\">\r\n                <Password ustk={ustk} />\r\n              </Route>\r\n              <Route component={General}>\r\n                <General ustk={ustk} erruserName={erruserName} onSubmitUpdateName={onSubmitUpdateName} onSubmitUpdateUserName={onSubmitUpdateUserName} loadingUpdateUsername={loadingUpdateUsername} loadingUpdateName={loadingUpdateName}/>\r\n              </Route>\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n  )\r\n}\r\nexport default Setting;\r\n"]},"metadata":{},"sourceType":"module"}