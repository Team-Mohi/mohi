{"ast":null,"code":"import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef,Suspense}from'react';import'./messenger.css';import{BsSearch,BsFillCameraVideoFill,BsThreeDotsVertical,BsImage,BsPencilSquare}from'react-icons/bs';import{AiTwotoneSetting,AiTwotoneLike,AiFillFile,AiFillCamera,AiFillCloseCircle}from'react-icons/ai';import{Link,Route,Switch,useHistory}from'react-router-dom';import{Image,Transformation}from'cloudinary-react';import useWindowSize from\"./useWindowSize.jsx\";import{ContentMessenger}from\"./ContentMessenger.jsx\";import{Row}from'antd';import{useSelector}from'react-redux';import moment from'moment';function Messenger(props,_ref){var message=_ref.message;var _useSelector=useSelector(function(state){return state.message;}),list=_useSelector.list;var heightScrollSider=window.innerHeight-190;var history=useHistory();var windowSize=useWindowSize();var _useState=useState({height:heightScrollSider}),_useState2=_slicedToArray(_useState,2),showScroll=_useState2[0],setShowScroll=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),contentChat=_useState4[0],setContentChat=_useState4[1];moment.updateLocale('en',{relativeTime:{future:\"%s\",past:\"%s\",s:'vài giây',ss:'%d phút',m:\"1 phút\",mm:\"%d phút\",h:\"%d giờ\",hh:\"%d giờ\",d:\"một ngày\",dd:\"%d ngày\",w:\"một tuần\",ww:\"%d tuần\",M:\"một tháng\",MM:\"%d tháng\",y:\"một năm\",yy:\"%d năm\"}});useEffect(function(){setShowScroll({height:heightScrollSider});},[windowSize]);var openContentChat=function openContentChat(idUser){history.push('/messenger/'+idUser);};var getMessageOneUser=function getMessageOneUser(idUser){props.getMessageOneUser(idUser);};var SiderMessenger=function SiderMessenger(){var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),scrollSider=_useState6[0],setScrollSider=_useState6[1];var sider=useRef();function handleSiderScroll(){var scrollTop=sider.current.scrollTop;if(scrollTop>0&&!scrollSider)setScrollSider({boxShadow:'-4px 0.1px 3px rgba(0,0,0,0.2)'});if(scrollTop===0)setScrollSider({});}return/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-head\",style:scrollSider},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-title-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-avatar\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://kenh14cdn.com/2017/21586912-1799665170046947-938789926401694671-o-1506075000161.jpg\",alt:\"\"})),/*#__PURE__*/React.createElement(\"span\",null,\"Chat\")),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-title-right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-setting\"},/*#__PURE__*/React.createElement(AiTwotoneSetting,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-search\"},/*#__PURE__*/React.createElement(BsSearch,null),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"T\\xECm ki\\u1EBFm tr\\xEAn Messenger\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-list-user-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-list-user\",style:showScroll,onScroll:function onScroll(){return handleSiderScroll();},ref:sider},/*#__PURE__*/React.createElement(\"ul\",null,list.map(function(mess,index){return/*#__PURE__*/React.createElement(\"li\",{key:index,onClick:function onClick(){return openContentChat(mess.id);}},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-user-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-user-item-avatar\"},mess.user_avatar_cropX===null?/*#__PURE__*/React.createElement(\"img\",{src:mess.user_avatar,alt:mess.user_last_name}):/*#__PURE__*/React.createElement(Image,{cloudName:\"mohi-vn\",publicId:mess.user_avatar+\".jpg\",version:\"1607061343\"},/*#__PURE__*/React.createElement(Transformation,{height:mess.user_avatar_cropH,width:mess.user_avatar_cropW,x:mess.user_avatar_cropX,y:mess.user_avatar_cropY,crop:\"crop\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-username\"},mess.user_first_name+' '+mess.user_last_name),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-content-nearest\"},mess.pivot.messages_Message)),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-time-send\"},moment(mess.pivot.created_at,\"YYYYMMDD\\h:m:s\").fromNow())),/*#__PURE__*/React.createElement(\"div\",{className:\"sider-messenger-user-item-status\"}));})))));};var ChatHello=function ChatHello(){return/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-container content-hello\"},/*#__PURE__*/React.createElement(\"p\",null,\"MOHI\"),/*#__PURE__*/React.createElement(\"p\",null,\"Xin ch\\xE0o b\\u1EA1n\"),/*#__PURE__*/React.createElement(\"p\",null,\"H\\xE3y nh\\u1EAFn tin cho b\\u1EA1n b\\xE8 \\u0111i n\\xE0o\"));};return/*#__PURE__*/React.createElement(\"div\",{className:\"messenger-container\"},/*#__PURE__*/React.createElement(SiderMessenger,null),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/messenger\"},/*#__PURE__*/React.createElement(ChatHello,null)),/*#__PURE__*/React.createElement(Suspense,{fallback:/*#__PURE__*/React.createElement(\"div\",null,\"loading\")},/*#__PURE__*/React.createElement(Route,{path:\"/messenger/:idUser\"},/*#__PURE__*/React.createElement(ContentMessenger,{getMessageOneUser:getMessageOneUser})))));}export default Messenger;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/Messenger/index.jsx"],"names":["React","useEffect","useState","useRef","Suspense","BsSearch","BsFillCameraVideoFill","BsThreeDotsVertical","BsImage","BsPencilSquare","AiTwotoneSetting","AiTwotoneLike","AiFillFile","AiFillCamera","AiFillCloseCircle","Link","Route","Switch","useHistory","Image","Transformation","useWindowSize","ContentMessenger","Row","useSelector","moment","Messenger","props","message","state","list","heightScrollSider","window","innerHeight","history","windowSize","height","showScroll","setShowScroll","contentChat","setContentChat","updateLocale","relativeTime","future","past","s","ss","m","mm","h","hh","d","dd","w","ww","M","MM","y","yy","openContentChat","idUser","push","getMessageOneUser","SiderMessenger","scrollSider","setScrollSider","sider","handleSiderScroll","scrollTop","current","boxShadow","map","mess","index","id","user_avatar_cropX","user_avatar","user_last_name","user_avatar_cropH","user_avatar_cropW","user_avatar_cropY","user_first_name","pivot","messages_Message","created_at","fromNow","ChatHello"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useRef, Suspense} from 'react';\r\nimport './messenger.css';\r\nimport {BsSearch, BsFillCameraVideoFill, BsThreeDotsVertical, BsImage, BsPencilSquare} from 'react-icons/bs';\r\nimport {AiTwotoneSetting, AiTwotoneLike, AiFillFile, AiFillCamera, AiFillCloseCircle} from 'react-icons/ai';\r\nimport {Link, Route, Switch, useHistory} from 'react-router-dom';\r\nimport {Image,Transformation} from 'cloudinary-react';\r\nimport useWindowSize from \"./useWindowSize.jsx\";\r\nimport {ContentMessenger} from \"./ContentMessenger.jsx\";\r\nimport {Row} from 'antd';\r\nimport {useSelector} from 'react-redux';\r\nimport moment from 'moment';\r\n\r\nfunction Messenger(props, { message }){\r\n  const {list} = useSelector(state => state.message);\r\n\r\n  const heightScrollSider = window.innerHeight - 190;\r\n  const history = useHistory();\r\n  const windowSize = useWindowSize();\r\n  const [showScroll, setShowScroll] = useState({height: heightScrollSider})\r\n  const [contentChat, setContentChat] = useState(false)\r\n  moment.updateLocale('en', {\r\n    relativeTime : {\r\n        future: \"%s\",\r\n        past:   \"%s\",\r\n        s  : 'vài giây',\r\n        ss : '%d phút',\r\n        m:  \"1 phút\",\r\n        mm: \"%d phút\",\r\n        h:  \"%d giờ\",\r\n        hh: \"%d giờ\",\r\n        d:  \"một ngày\",\r\n        dd: \"%d ngày\",\r\n        w:  \"một tuần\",\r\n        ww: \"%d tuần\",\r\n        M:  \"một tháng\",\r\n        MM: \"%d tháng\",\r\n        y:  \"một năm\",\r\n        yy: \"%d năm\"\r\n    }\r\n  });\r\n  useEffect(() => {\r\n    setShowScroll({height: heightScrollSider})\r\n  },[windowSize]);\r\n\r\n  const openContentChat = (idUser) => {\r\n    history.push('/messenger/' + idUser)\r\n  }\r\n\r\n  const getMessageOneUser = (idUser) => {\r\n    props.getMessageOneUser(idUser)\r\n  }\r\n\r\n  const SiderMessenger = () => {\r\n    const [scrollSider, setScrollSider] = useState();\r\n    const sider = useRef();\r\n\r\n    function handleSiderScroll(){\r\n      const {scrollTop} = sider.current;\r\n      if(scrollTop > 0 && !scrollSider) setScrollSider({boxShadow: '-4px 0.1px 3px rgba(0,0,0,0.2)'})\r\n      if(scrollTop === 0) setScrollSider({})\r\n    }\r\n\r\n      return(\r\n        <div className=\"sider-messenger-container\">\r\n          <div className=\"sider-messenger-head\" style={scrollSider}>\r\n            <div className=\"sider-messenger-title\">\r\n              <div className=\"sider-messenger-title-left\">\r\n                <div className=\"sider-messenger-avatar\">\r\n                  <img src=\"https://kenh14cdn.com/2017/21586912-1799665170046947-938789926401694671-o-1506075000161.jpg\" alt=\"\" />\r\n                </div>\r\n                <span>Chat</span>\r\n              </div>\r\n              <div className=\"sider-messenger-title-right\">\r\n                <div className=\"sider-messenger-setting\">\r\n                  <AiTwotoneSetting />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"sider-messenger-search\">\r\n              <BsSearch />\r\n              <input type=\"text\" placeholder=\"Tìm kiếm trên Messenger\"/>\r\n            </div>\r\n          </div>\r\n          <div className=\"sider-messenger-list-user-container\" >\r\n            <div className=\"sider-messenger-list-user\" style={showScroll} onScroll={() => handleSiderScroll()} ref={sider}>\r\n              <ul>\r\n                {list.map((mess, index) => {\r\n                  return(\r\n                    <li key={index} onClick={() => openContentChat(mess.id)}>\r\n                      <div className=\"sider-messenger-user-item\">\r\n                        <div className=\"sider-messenger-user-item-avatar\">\r\n                          {mess.user_avatar_cropX === null ?\r\n                            <img src={mess.user_avatar} alt={mess.user_last_name} />\r\n                            :\r\n                            <Image cloudName=\"mohi-vn\" publicId={mess.user_avatar+ \".jpg\"} version=\"1607061343\">\r\n                              <Transformation height={mess.user_avatar_cropH}  width={mess.user_avatar_cropW} x={mess.user_avatar_cropX} y={mess.user_avatar_cropY} crop=\"crop\" />\r\n                            </Image>\r\n                          }\r\n                        </div>\r\n                        <div className=\"sider-messenger-content\">\r\n                          <div className=\"sider-messenger-username\">\r\n                            {mess.user_first_name + ' ' + mess.user_last_name}\r\n                          </div>\r\n                          <div className=\"sider-messenger-content-nearest\">\r\n                            {mess.pivot.messages_Message}\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"sider-messenger-time-send\">\r\n                          {moment(mess.pivot.created_at, \"YYYYMMDD\\h:m:s\").fromNow()}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"sider-messenger-user-item-status\">\r\n                      </div>\r\n                    </li>\r\n                  )\r\n                })}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n  }\r\n\r\n  const ChatHello = () => {\r\n    return(\r\n      <div className=\"content-messenger-container content-hello\">\r\n        <p>MOHI</p>\r\n        <p>Xin chào bạn</p>\r\n        <p>Hãy nhắn tin cho bạn bè đi nào</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return(\r\n      <div className=\"messenger-container\">\r\n        <SiderMessenger />\r\n        <Switch>\r\n          <Route exact path=\"/messenger\">\r\n            <ChatHello />\r\n          </Route>\r\n          <Suspense fallback={<div>loading</div>} >\r\n          <Route path=\"/messenger/:idUser\">\r\n            <ContentMessenger getMessageOneUser={getMessageOneUser}/>\r\n          </Route>\r\n          </Suspense>\r\n        </Switch>\r\n      </div>\r\n  )\r\n}\r\n\r\nexport default Messenger;\r\n"]},"metadata":{},"sourceType":"module"}