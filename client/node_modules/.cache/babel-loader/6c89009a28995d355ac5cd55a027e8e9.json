{"ast":null,"code":"import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import'./ModalAddWorkSpace.css';import{useDispatch,useSelector}from'react-redux';import{toggleStatusPresentialModal}from'./../../Actions/index.jsx';import{useForm}from\"react-hook-form\";import{WaveLoading}from'react-loadingg';import axios from'axios';import{RiErrorWarningLine}from'react-icons/ri';import{Tooltip}from'antd';import CheckOtp from'./checkOtp.jsx';function ModalEditEmail(_ref){var presentialModal=_ref.presentialModal;var statusPresentialModal=useSelector(function(state){return state.presentialModal;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCheckOtp=_useState2[0],setIsCheckOtp=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),otp=_useState4[0],setOtp=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),formData=_useState6[0],setFormData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loadingOtp=_useState8[0],setLoadingOtp=_useState8[1];var dispatch=useDispatch();var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,watch=_useForm.watch,errors=_useForm.errors,setError=_useForm.setError;var _useState9=useState('Email không đúng định dạng'),_useState10=_slicedToArray(_useState9,2),errorEmail=_useState10[0],setErrorEmail=_useState10[1];var onSubmit=function onSubmit(data){if(statusPresentialModal.data!==data.user_email){setLoadingOtp(true);axios.post(\"https://www.api.mohi.vn/api/auth/send-otp-add\",{user_email:data.user_email,action:'update'}).then(function(res){setLoadingOtp(false);setOtp(res.data.veri_code);setFormData(data);setIsCheckOtp(true);}).catch(function(e){setLoadingOtp(false);if(e.response.status===400){setError(\"user_email\",{type:\"manual\",message:\"Email hoặc số điện thoại đã được đăng kí\"});setErrorEmail('Email đã được đăng kí');}});}else{dispatch(toggleStatusPresentialModal());}};var validateInputEmail=function validateInputEmail(value){/* Email Test */var filter=/^[\\w.+\\-]+@gmail\\.com$/;if(filter.test(value)){return true;}return false;};if(isCheckOtp){return/*#__PURE__*/React.createElement(CheckOtp,{formData:formData,otp:otp});}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"modal-custom modal-add-work-space\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-add-work-space-header\"},\"Ch\\u1EC9nh s\\u1EEDa email c\\u1EE7a b\\u1EA1n\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-add-work-space-main\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-add-work-space-main-input\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\"},\"Email c\\u1EE7a b\\u1EA1n\"),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-add-email-main-input\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"user_email\",id:\"\",defaultValue:statusPresentialModal.data,ref:register({validate:function validate(value){return validateInputEmail(value);}})}),errors.user_email&&/*#__PURE__*/React.createElement(Tooltip,{placement:\"bottom\",trigger:\"click\",title:/*#__PURE__*/React.createElement(\"p\",{className:\"error_sex_tooltip\"},errorEmail)},/*#__PURE__*/React.createElement(RiErrorWarningLine,{className:\"error_sex\"}))))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-add-work-space-footer\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"X\\xE1c nh\\u1EADn\"),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return dispatch(toggleStatusPresentialModal());}},\"H\\u1EE7y\"))),loadingOtp&&/*#__PURE__*/React.createElement(\"div\",{style:{background:'rgba(255,255,255,0.7)',position:'absolute',width:'100%',height:'100%',top:0,left:0}},/*#__PURE__*/React.createElement(WaveLoading,null))));}export default ModalEditEmail;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/PresentialModal/ModalEditEmail.jsx"],"names":["React","useState","useDispatch","useSelector","toggleStatusPresentialModal","useForm","WaveLoading","axios","RiErrorWarningLine","Tooltip","CheckOtp","ModalEditEmail","presentialModal","statusPresentialModal","state","isCheckOtp","setIsCheckOtp","otp","setOtp","formData","setFormData","loadingOtp","setLoadingOtp","dispatch","register","handleSubmit","watch","errors","setError","errorEmail","setErrorEmail","onSubmit","data","user_email","post","action","then","res","veri_code","catch","e","response","status","type","message","validateInputEmail","value","filter","test","validate","background","position","width","height","top","left"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport './ModalAddWorkSpace.css';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { toggleStatusPresentialModal } from './../../Actions/index.jsx';\r\nimport { useForm } from \"react-hook-form\";\r\nimport { WaveLoading } from 'react-loadingg';\r\nimport axios from 'axios';\r\nimport {RiErrorWarningLine} from 'react-icons/ri';\r\nimport {Tooltip} from 'antd';\r\nimport CheckOtp from './checkOtp.jsx';\r\n\r\nfunction ModalEditEmail({ presentialModal}) {\r\n    const statusPresentialModal = useSelector(state => state.presentialModal);\r\n    const [isCheckOtp, setIsCheckOtp] = useState(false);\r\n    const [otp, setOtp] = useState();\r\n    const [formData, setFormData] = useState(false);\r\n    const [loadingOtp, setLoadingOtp] = useState(false);\r\n    const dispatch = useDispatch();\r\n    const { register, handleSubmit, watch, errors, setError } = useForm();\r\n    const [errorEmail, setErrorEmail] = useState('Email không đúng định dạng');\r\n\r\n\r\n    const onSubmit = (data) => {\r\n      if(statusPresentialModal.data !== data.user_email){\r\n        setLoadingOtp(true)\r\n\r\n        axios.post(\"https://www.api.mohi.vn/api/auth/send-otp-add\", {user_email:data.user_email, action: 'update'})\r\n        .then((res) => {\r\n          setLoadingOtp(false)\r\n          setOtp(res.data.veri_code)\r\n          setFormData(data)\r\n          setIsCheckOtp(true)\r\n        })\r\n        .catch((e) => {\r\n          setLoadingOtp(false)\r\n          if(e.response.status === 400){\r\n            setError(\"user_email\", {\r\n                  type: \"manual\",\r\n                  message: \"Email hoặc số điện thoại đã được đăng kí\"\r\n                });\r\n            setErrorEmail('Email đã được đăng kí')\r\n          }\r\n        })\r\n      }else {\r\n        dispatch(toggleStatusPresentialModal())\r\n      }\r\n    }\r\n\r\n    const validateInputEmail = (value) => {\r\n      /* Email Test */\r\n      var filter = /^[\\w.+\\-]+@gmail\\.com$/;\r\n      if (filter.test(value)) {\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n\r\n\r\n    if(isCheckOtp){\r\n        return(\r\n          <CheckOtp formData={formData} otp={otp}/>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <div className=\"modal-custom modal-add-work-space\">\r\n                <div className=\"modal-add-work-space-header\">\r\n                    Chỉnh sửa email của bạn\r\n                </div>\r\n                <form onSubmit={handleSubmit(onSubmit)}>\r\n                    <div className=\"modal-add-work-space-main\">\r\n                        <div className=\"modal-add-work-space-main-input\">\r\n                            <label htmlFor=\"\">Email của bạn</label>\r\n                              <div className=\"modal-add-email-main-input\">\r\n                                <input type=\"text\" name=\"user_email\" id=\"\" defaultValue={statusPresentialModal.data} ref={register({\r\n                                    validate: value => validateInputEmail(value)\r\n                                  })} />\r\n                                {errors.user_email && <Tooltip placement=\"bottom\" trigger=\"click\" title={<p className = \"error_sex_tooltip\" >\r\n                                    {errorEmail}\r\n                                    </p>}><RiErrorWarningLine className=\"error_sex\"/></Tooltip>\r\n                                }\r\n                              </div>\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div className=\"modal-add-work-space-footer\">\r\n                        <button type=\"submit\">Xác nhận</button>\r\n                        <button onClick={ () => dispatch(toggleStatusPresentialModal())} >Hủy</button>\r\n                    </div>\r\n                </form>\r\n                { loadingOtp && <div style={{background: 'rgba(255,255,255,0.7)', position: 'absolute', width: '100%', height: '100%', top: 0, left: 0}}><WaveLoading /></div>}\r\n            </div>\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\nexport default ModalEditEmail;\r\n"]},"metadata":{},"sourceType":"module"}