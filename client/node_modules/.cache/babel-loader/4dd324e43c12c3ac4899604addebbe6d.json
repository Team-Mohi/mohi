{"ast":null,"code":"import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef,useCallback}from'react';import{FaSmile}from'react-icons/fa';import{GiPhone}from'react-icons/gi';import{BsSearch,BsFillCameraVideoFill,BsThreeDotsVertical,BsImage,BsPencilSquare}from'react-icons/bs';import{AiTwotoneSetting,AiTwotoneLike,AiFillFile,AiFillCamera,AiFillCloseCircle}from'react-icons/ai';import{Row,Spin}from'antd';import useWindowSize from\"./useWindowSize.jsx\";import{useSelector,useDispatch}from'react-redux';import{useParams}from'react-router-dom';import{setCurrentOneMessage}from'./../../Actions/index.jsx';export var ContentMessenger=function ContentMessenger(props,_ref){var oneMessage=_ref.oneMessage;var _useParams=useParams(),idUser=_useParams.idUser;var observer=useRef();var keepScrollToBottom=useRef();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.oneMessage;}),list=_useSelector.list,infoUser=_useSelector.infoUser,loading=_useSelector.loading,hasMore=_useSelector.hasMore,loadingMore=_useSelector.loadingMore;var heightContent=window.innerHeight-134;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),setupFakeName=_useState2[0],setSetupFakeName=_useState2[1];var _useState3=useState({height:heightContent}),_useState4=_slicedToArray(_useState3,2),heightContentBody=_useState4[0],setHeightContentBody=_useState4[1];var windowSize=useWindowSize();var _useState5=useState({height:heightContent-56}),_useState6=_slicedToArray(_useState5,2),heightRoom=_useState6[0],setHeightRoom=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showSearchRoomChat=_useState8[0],setShowSearchRoomChat=_useState8[1];var currentUser=JSON.parse(localStorage.getItem('ustk')).info;useEffect(function(){props.getMessageOneUser(idUser);},[idUser]);useEffect(function(){if(keepScrollToBottom.current){keepScrollToBottom.current.scrollTop=keepScrollToBottom.current.scrollHeight;}},[loading]);useEffect(function(){setHeightContentBody({height:heightContent});setHeightRoom({height:heightContent-56});},[windowSize]);var lastMessage=useCallback(function(node){if(loadingMore)return;if(observer.current)observer.current.disconnect();observer.current=new IntersectionObserver(function(entries){if(entries[0].isIntersecting&&hasMore){dispatch(setCurrentOneMessage());keepScrollToBottom.current.scrollTop=500;}});if(node)observer.current.observe(node);},[loadingMore,hasMore]);function setupFakeNameFunc(){setSetupFakeName(true);}function saveFakeNameFunc(){setSetupFakeName(false);}function showSearchRoomChatFunc(){setShowSearchRoomChat(true);}function hideSearchRoomChatFunc(){setShowSearchRoomChat(false);}if(loading){return/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-container\",style:{display:'flex',alignItems:'center',justifyContent:'center'}},/*#__PURE__*/React.createElement(Spin,null));}return/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-head\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-info-avatar\"},/*#__PURE__*/React.createElement(\"img\",{src:infoUser.user_avatar,alt:infoUser.user_first_name+' '+infoUser.user_last_name})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-info-name\"},infoUser.user_first_name+' '+infoUser.user_last_name),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-info-status\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u0110ang ho\\u1EA1t \\u0111\\u1ED9ng\"),\" \",/*#__PURE__*/React.createElement(\"p\",null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-option\"},/*#__PURE__*/React.createElement(GiPhone,null),/*#__PURE__*/React.createElement(BsFillCameraVideoFill,null),/*#__PURE__*/React.createElement(BsThreeDotsVertical,null))),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body\",style:heightContentBody},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-room\",style:heightRoom,ref:keepScrollToBottom},loadingMore&&/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'center',background:'rgba(0,128,128,0.3)',marginBottom:'10px',borderRadius:'3px',padding:'3px'}},\"\\u0110ang t\\u1EA3i th\\xEAm tin nh\\u1EAFn vui l\\xF2ng \\u0111\\u1EE3i...\"),list.map(function(mess,index){if(mess.messages_From===currentUser.id){return/*#__PURE__*/React.createElement(React.Fragment,{key:index},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-my-chat\",ref:index===0?lastMessage:null},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-my-chat-content\"},/*#__PURE__*/React.createElement(\"p\",null,mess.messages_Message),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-my-chat-content-status\"},/*#__PURE__*/React.createElement(\"img\",{src:mess.user_send.user_avatar,alt:mess.user_send.user_first_name+' '+mess.user_send.user_last_name})))),/*#__PURE__*/React.createElement(\"div\",{className:\"clear\"}));}else{return/*#__PURE__*/React.createElement(React.Fragment,{key:index},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-user-chat\",ref:index===0?lastMessage:null},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-user-chat-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-user-chat-content-avatar\"},/*#__PURE__*/React.createElement(\"img\",{src:mess.user_send.user_avatar,alt:mess.user_send.user_first_name+' '+mess.user_send.user_last_name})),/*#__PURE__*/React.createElement(\"p\",null,mess.messages_Message))),/*#__PURE__*/React.createElement(\"div\",{className:\"clear\"}));}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-input\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-input-file\"},/*#__PURE__*/React.createElement(AiFillCamera,null),/*#__PURE__*/React.createElement(AiFillFile,null),/*#__PURE__*/React.createElement(BsImage,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-input-text\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Nh\\u1EADp tin nh\\u1EAFn...\"}),/*#__PURE__*/React.createElement(FaSmile,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-input-react\"},/*#__PURE__*/React.createElement(AiTwotoneLike,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-title\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-head\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-head-avatar\"},/*#__PURE__*/React.createElement(\"img\",{src:infoUser.user_avatar,alt:infoUser.user_first_name+' '+infoUser.user_last_name}))),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-head-name\"},infoUser.user_first_name+' '+infoUser.user_last_name)),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"content-messenger-body-right-support-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-title\"},\"H\\xE0nh \\u0111\\u1ED9ng kh\\xE1c\"),/*#__PURE__*/React.createElement(\"li\",null,showSearchRoomChat?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-item-title\",style:{width:'100%'}},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"T\\xECm ki\\u1EBFm trong cu\\u1ED9c tr\\xF2 chuy\\u1EC7n\",style:{width:'90%'}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-icon\",onClick:function onClick(){return hideSearchRoomChatFunc();}},/*#__PURE__*/React.createElement(AiFillCloseCircle,null))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-item-title\",onClick:function onClick(){return showSearchRoomChatFunc();}},\"T\\xECm ki\\u1EBFm trong cu\\u1ED9c tr\\xF2 chuy\\u1EC7n\"),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-icon\",onClick:function onClick(){return showSearchRoomChatFunc();}},/*#__PURE__*/React.createElement(BsSearch,null)))),/*#__PURE__*/React.createElement(\"li\",null,setupFakeName?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-item-title\",style:{width:'100%'}},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Ch\\u1EC9nh s\\u1EEDa bi\\u1EC7t danh\",style:{width:'90%'}})),/*#__PURE__*/React.createElement(\"button\",{className:\"save-fakename\",onClick:function onClick(){return saveFakeNameFunc();}},\"L\\u01B0u\")):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-item-title\",onClick:function onClick(){return setupFakeNameFunc();}},\"Ch\\u1EC9nh s\\u1EEDa bi\\u1EC7t danh\"),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-icon\",onClick:function onClick(){return setupFakeNameFunc();}},/*#__PURE__*/React.createElement(BsPencilSquare,null))))),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-support-title\"},\"\\u1EA2nh \\u0111\\xE3 chia s\\u1EBB\"),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share-item\"},/*#__PURE__*/React.createElement(\"i\",{style:{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share-item\"},/*#__PURE__*/React.createElement(\"i\",{style:{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share-item\"},/*#__PURE__*/React.createElement(\"i\",{style:{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share-item\"},/*#__PURE__*/React.createElement(\"i\",{style:{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share-item\"},/*#__PURE__*/React.createElement(\"i\",{style:{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}})),/*#__PURE__*/React.createElement(\"div\",{className:\"content-messenger-body-right-list-iamge-share-item\"},/*#__PURE__*/React.createElement(\"i\",{style:{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}})))))))));};","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/Messenger/ContentMessenger.jsx"],"names":["React","useState","useEffect","useRef","useCallback","FaSmile","GiPhone","BsSearch","BsFillCameraVideoFill","BsThreeDotsVertical","BsImage","BsPencilSquare","AiTwotoneSetting","AiTwotoneLike","AiFillFile","AiFillCamera","AiFillCloseCircle","Row","Spin","useWindowSize","useSelector","useDispatch","useParams","setCurrentOneMessage","ContentMessenger","props","oneMessage","idUser","observer","keepScrollToBottom","dispatch","state","list","infoUser","loading","hasMore","loadingMore","heightContent","window","innerHeight","setupFakeName","setSetupFakeName","height","heightContentBody","setHeightContentBody","windowSize","heightRoom","setHeightRoom","showSearchRoomChat","setShowSearchRoomChat","currentUser","JSON","parse","localStorage","getItem","info","getMessageOneUser","current","scrollTop","scrollHeight","lastMessage","node","disconnect","IntersectionObserver","entries","isIntersecting","observe","setupFakeNameFunc","saveFakeNameFunc","showSearchRoomChatFunc","hideSearchRoomChatFunc","display","alignItems","justifyContent","user_avatar","user_first_name","user_last_name","textAlign","background","marginBottom","borderRadius","padding","map","mess","index","messages_From","id","messages_Message","user_send","width","backgroundImage"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef, useCallback} from 'react';\r\nimport {FaSmile} from 'react-icons/fa';\r\nimport {GiPhone} from 'react-icons/gi';\r\nimport {BsSearch, BsFillCameraVideoFill, BsThreeDotsVertical, BsImage, BsPencilSquare} from 'react-icons/bs';\r\nimport {AiTwotoneSetting, AiTwotoneLike, AiFillFile, AiFillCamera, AiFillCloseCircle} from 'react-icons/ai';\r\nimport {Row, Spin} from 'antd';\r\nimport useWindowSize from \"./useWindowSize.jsx\";\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useParams } from 'react-router-dom';\r\nimport {setCurrentOneMessage} from './../../Actions/index.jsx';\r\n\r\nexport const ContentMessenger = (props, {oneMessage}) => {\r\n  const {idUser} = useParams();\r\n  const observer = useRef();\r\n  const keepScrollToBottom = useRef();\r\n  const dispatch = useDispatch();\r\n  const {list, infoUser, loading, hasMore, loadingMore} = useSelector(state => state.oneMessage);\r\n  const heightContent = window.innerHeight - 134;\r\n  const [setupFakeName, setSetupFakeName] = useState(false)\r\n  const [heightContentBody, setHeightContentBody] = useState({height: heightContent})\r\n  const windowSize = useWindowSize();\r\n  const [heightRoom, setHeightRoom] = useState({height: heightContent - 56})\r\n  const [showSearchRoomChat, setShowSearchRoomChat] = useState(false)\r\n  const currentUser = JSON.parse(localStorage.getItem('ustk')).info;\r\n\r\n  useEffect(() => {\r\n    props.getMessageOneUser(idUser)\r\n  }, [idUser])\r\n\r\n  useEffect(() => {\r\n    if(keepScrollToBottom.current) {\r\n        keepScrollToBottom.current.scrollTop = keepScrollToBottom.current.scrollHeight;\r\n    }\r\n  }, [loading])\r\n\r\n  useEffect(() => {\r\n    setHeightContentBody({height: heightContent})\r\n    setHeightRoom({height: heightContent - 56})\r\n  },[windowSize])\r\n\r\n  const lastMessage = useCallback(node => {\r\n    if(loadingMore) return\r\n      if(observer.current) observer.current.disconnect()\r\n      observer.current = new IntersectionObserver(entries => {\r\n        if(entries[0].isIntersecting && hasMore){\r\n          dispatch(setCurrentOneMessage())\r\n          keepScrollToBottom.current.scrollTop = 500;\r\n        }\r\n      })\r\n    if(node) observer.current.observe(node)\r\n  }, [loadingMore, hasMore])\r\n\r\n  function setupFakeNameFunc(){\r\n    setSetupFakeName(true)\r\n  }\r\n\r\n  function saveFakeNameFunc(){\r\n    setSetupFakeName(false)\r\n  }\r\n\r\n  function showSearchRoomChatFunc(){\r\n    setShowSearchRoomChat(true)\r\n  }\r\n\r\n  function hideSearchRoomChatFunc(){\r\n    setShowSearchRoomChat(false)\r\n  }\r\n\r\n    if(loading){\r\n      return(\r\n        <div className=\"content-messenger-container\" style={{display: 'flex', alignItems:'center', justifyContent: 'center'}}>\r\n          <Spin />\r\n        </div>\r\n      )\r\n    }\r\n      return(\r\n        <div className=\"content-messenger-container\">\r\n          <div className=\"content-messenger-head\">\r\n            <div className=\"content-messenger-info\">\r\n              <div className=\"content-messenger-info-avatar\">\r\n                <img src={infoUser.user_avatar} alt={infoUser.user_first_name + ' ' + infoUser.user_last_name} />\r\n              </div>\r\n              <div>\r\n                <div className=\"content-messenger-info-name\">{infoUser.user_first_name + ' ' + infoUser.user_last_name}</div>\r\n                <div className=\"content-messenger-info-status\"><span>Đang hoạt động</span> <p></p></div>\r\n              </div>\r\n            </div>\r\n            <div className=\"content-messenger-option\">\r\n              <GiPhone />\r\n              <BsFillCameraVideoFill />\r\n              <BsThreeDotsVertical />\r\n            </div>\r\n          </div>\r\n          <div className=\"content-messenger-body\" style={heightContentBody}>\r\n            <div className=\"content-messenger-body-left\" >\r\n              <div className=\"content-messenger-room\" style={heightRoom} ref={keepScrollToBottom}>\r\n                {loadingMore && <div style={{textAlign: 'center', background: 'rgba(0,128,128,0.3)', marginBottom: '10px', borderRadius: '3px', padding: '3px' }}>Đang tải thêm tin nhắn vui lòng đợi...</div>}\r\n                {list.map((mess, index) => {\r\n                  if(mess.messages_From === currentUser.id){\r\n                    return(\r\n                      <React.Fragment key={index}>\r\n                        <div className=\"content-messenger-my-chat\" ref={index === 0 ? lastMessage : null}>\r\n                          <div className=\"content-messenger-my-chat-content\">\r\n                            <p>{mess.messages_Message}</p>\r\n                            <div className=\"content-messenger-my-chat-content-status\">\r\n                              <img src={mess.user_send.user_avatar} alt={mess.user_send.user_first_name + ' ' + mess.user_send.user_last_name} />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"clear\"></div>\r\n                      </React.Fragment>\r\n                    )\r\n                  }else {\r\n                    return(\r\n                      <React.Fragment key={index}>\r\n                        <div className=\"content-messenger-user-chat\" ref={index === 0 ? lastMessage : null}>\r\n                          <div className=\"content-messenger-user-chat-content\">\r\n                            <div className=\"content-messenger-user-chat-content-avatar\">\r\n                              <img src={mess.user_send.user_avatar} alt={mess.user_send.user_first_name + ' ' + mess.user_send.user_last_name} />\r\n                            </div>\r\n                            <p>{mess.messages_Message}</p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"clear\"></div>\r\n                      </React.Fragment>\r\n                    )\r\n                  }\r\n                })}\r\n              </div>\r\n              <div className=\"content-messenger-input\">\r\n                <div className=\"content-messenger-input-file\">\r\n                  <AiFillCamera />\r\n                  <AiFillFile />\r\n                  <BsImage />\r\n                </div>\r\n                <div className=\"content-messenger-input-text\">\r\n                  <input type=\"text\" placeholder=\"Nhập tin nhắn...\"/>\r\n                  <FaSmile />\r\n                </div>\r\n                <div className=\"content-messenger-input-react\">\r\n                  <AiTwotoneLike />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"content-messenger-body-right\">\r\n              <div className=\"content-messenger-body-right-title\">\r\n                <div className=\"content-messenger-body-right-head\">\r\n                  <div className=\"content-messenger-body-right-head-avatar\">\r\n                    <img src={infoUser.user_avatar} alt={infoUser.user_first_name + ' ' + infoUser.user_last_name} />\r\n                  </div>\r\n                </div>\r\n                <div className=\"content-messenger-body-right-head-name\">\r\n                  {infoUser.user_first_name + ' ' + infoUser.user_last_name}\r\n                </div>\r\n              </div>\r\n              <div className=\"content-messenger-body-right-support\">\r\n                <ul className=\"content-messenger-body-right-support-item\">\r\n                  <div className=\"content-messenger-body-right-support-title\">\r\n                    Hành động khác\r\n                  </div>\r\n                  <li>\r\n                    {showSearchRoomChat ?\r\n                      <>\r\n                    <div className=\"content-messenger-body-right-support-item-title\" style={{width: '100%'}}>\r\n                        <input type=\"text\" placeholder=\"Tìm kiếm trong cuộc trò chuyện\" style={{width: '90%'}}/>\r\n                    </div>\r\n                    <div className=\"content-messenger-body-right-support-icon\" onClick={() => hideSearchRoomChatFunc()}>\r\n                      <AiFillCloseCircle />\r\n                    </div>\r\n                    </>\r\n                    :\r\n                    <>\r\n                      <div className=\"content-messenger-body-right-support-item-title\" onClick={() => showSearchRoomChatFunc()}>\r\n                        Tìm kiếm trong cuộc trò chuyện\r\n                      </div>\r\n                      <div className=\"content-messenger-body-right-support-icon\" onClick={() => showSearchRoomChatFunc()}>\r\n                        <BsSearch />\r\n                      </div>\r\n                    </>\r\n                    }\r\n                  </li>\r\n                  <li>\r\n                  {setupFakeName ?\r\n                      <>\r\n                      <div className=\"content-messenger-body-right-support-item-title\" style={{width: '100%'}}>\r\n                          <input type=\"text\" placeholder=\"Chỉnh sửa biệt danh\" style={{width: '90%'}}/>\r\n                      </div>\r\n                      <button className=\"save-fakename\" onClick={() => saveFakeNameFunc()}>Lưu</button>\r\n                      </>\r\n                    :\r\n                    <>\r\n                    <div className=\"content-messenger-body-right-support-item-title\" onClick={() => setupFakeNameFunc()}>\r\n                      Chỉnh sửa biệt danh\r\n                    </div>\r\n                    <div className=\"content-messenger-body-right-support-icon\" onClick={() => setupFakeNameFunc()}>\r\n                      <BsPencilSquare />\r\n                    </div>\r\n                    </>\r\n                    }\r\n                  </li>\r\n                </ul>\r\n                <div className=\"content-messenger-body-right-support-item\">\r\n                  <div className=\"content-messenger-body-right-support-title\">\r\n                    Ảnh đã chia sẻ\r\n                  </div>\r\n                  <div className=\"content-messenger-body-right-list-iamge-share\">\r\n                    <Row>\r\n                      <div className=\"content-messenger-body-right-list-iamge-share-item\">\r\n                        <i style={{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}}></i>\r\n                      </div>\r\n                      <div className=\"content-messenger-body-right-list-iamge-share-item\">\r\n                        <i style={{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}}></i>\r\n                      </div>\r\n                      <div className=\"content-messenger-body-right-list-iamge-share-item\">\r\n                        <i style={{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}}></i>\r\n                      </div>\r\n                      <div className=\"content-messenger-body-right-list-iamge-share-item\">\r\n                        <i style={{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}}></i>\r\n                      </div>\r\n                      <div className=\"content-messenger-body-right-list-iamge-share-item\">\r\n                        <i style={{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}}></i>\r\n                      </div>\r\n                      <div className=\"content-messenger-body-right-list-iamge-share-item\">\r\n                        <i style={{backgroundImage:'url(\"https://scontent.fvca1-1.fna.fbcdn.net/v/t1.0-0/s600x600/120467372_1235184720184447_7169794468845396216_o.jpg?_nc_cat=103&_nc_sid=8024bb&_nc_ohc=orfey83uSHgAX_dn_Hh&_nc_ht=scontent.fvca1-1.fna&tp=7&oh=b1548bb34d2694c57b096aee2e8cde2c&oe=5F9F0901\")'}}></i>\r\n                      </div>\r\n                    </Row>\r\n                  </div>\r\n\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n  }\r\n"]},"metadata":{},"sourceType":"module"}