{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import CreatePost from'./../Components/NewFeed/CreatePost.jsx';import axios from'axios';import{useDispatch}from'react-redux';import{addNewStory}from'./../Actions/index.jsx';import{requestAddNewStory}from'./../Actions/index.jsx';function CreatePostContainer(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),statusCreatePost=_useState2[0],setStatusCreatePost=_useState2[1];var dispatch=useDispatch();var submitCreatePost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(valueEditor,fileList,privacyNewFeed,privacyStory,placeNewFeed,placeStory,listMention){var mention,tags,tag,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setStatusCreatePost('loading');mention=[];listMention.map(function(m){mention.push(m.data.mention.id);});tags=mention.filter(function(value,index,mention){return mention.indexOf(value)===index;});tag=tags.toString();data={placeStory:placeStory,placePost:placeNewFeed,post_Content:valueEditor,post_Privacy:privacyNewFeed,tag_users_UserId:tag,story_Privacy:privacyStory,post_images_Url:fileList};_context.next=8;return axios.post('https://www.api.mohi.vn/api/auth/create-post-profile',data).then(function(res){setStatusCreatePost('success');props.successCreatePost(res.data);if(res.data.newStory.length){dispatch(requestAddNewStory());axios.get(\"https://www.api.mohi.vn/api/auth/get-story-home\").then(function(res){dispatch(addNewStory(res.data));});}}).catch(function(e){setStatusCreatePost('error');props.errorCreatePost();});case 8:case\"end\":return _context.stop();}}},_callee);}));return function submitCreatePost(_x,_x2,_x3,_x4,_x5,_x6,_x7){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(CreatePost,{submitCreatePost:submitCreatePost,statusCreatePost:statusCreatePost});}export default CreatePostContainer;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Containers/CreatePostContainer.jsx"],"names":["React","useState","CreatePost","axios","useDispatch","addNewStory","requestAddNewStory","CreatePostContainer","props","statusCreatePost","setStatusCreatePost","dispatch","submitCreatePost","valueEditor","fileList","privacyNewFeed","privacyStory","placeNewFeed","placeStory","listMention","mention","map","m","push","data","id","tags","filter","value","index","indexOf","tag","toString","placePost","post_Content","post_Privacy","tag_users_UserId","story_Privacy","post_images_Url","post","then","res","successCreatePost","newStory","length","get","catch","e","errorCreatePost"],"mappings":"gbAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,KAA8B,OAA9B,CACA,MAAOC,CAAAA,UAAP,KAAuB,wCAAvB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,WAAT,KAA4B,wBAA5B,CACA,OAASC,kBAAT,KAAmC,wBAAnC,CAEA,QAASC,CAAAA,mBAAT,CAA6BC,KAA7B,CAAmC,eACeP,QAAQ,EADvB,wCAC1BQ,gBAD0B,eACRC,mBADQ,eAEjC,GAAMC,CAAAA,QAAQ,CAAGP,WAAW,EAA5B,CAEA,GAAMQ,CAAAA,gBAAgB,0FAAG,iBAAOC,WAAP,CAAoBC,QAApB,CAA8BC,cAA9B,CAA8CC,YAA9C,CAA4DC,YAA5D,CAA0EC,UAA1E,CAAsFC,WAAtF,4IACvBT,mBAAmB,CAAC,SAAD,CAAnB,CACIU,OAFmB,CAET,EAFS,CAGvBD,WAAW,CAACE,GAAZ,CAAgB,SAAAC,CAAC,CAAI,CACnBF,OAAO,CAACG,IAAR,CAAaD,CAAC,CAACE,IAAF,CAAOJ,OAAP,CAAeK,EAA5B,EACD,CAFD,EAGIC,IANmB,CAMZN,OAAO,CAACO,MAAR,CAAe,SAACC,KAAD,CAAQC,KAAR,CAAeT,OAAf,QAA2BA,CAAAA,OAAO,CAACU,OAAR,CAAgBF,KAAhB,IAA2BC,KAAtD,EAAf,CANY,CAOnBE,GAPmB,CAObL,IAAI,CAACM,QAAL,EAPa,CASnBR,IATmB,CASZ,CACTN,UAAU,CAAEA,UADH,CAETe,SAAS,CAAEhB,YAFF,CAGTiB,YAAY,CAAErB,WAHL,CAITsB,YAAY,CAAEpB,cAJL,CAKTqB,gBAAgB,CAAEL,GALT,CAMTM,aAAa,CAAErB,YANN,CAOTsB,eAAe,CAAExB,QAPR,CATY,uBAkBjBX,CAAAA,KAAK,CAACoC,IAAN,CAAW,sDAAX,CAAmEf,IAAnE,EAAyEgB,IAAzE,CAA8E,SAACC,GAAD,CAAS,CAC3F/B,mBAAmB,CAAC,SAAD,CAAnB,CACAF,KAAK,CAACkC,iBAAN,CAAwBD,GAAG,CAACjB,IAA5B,EACA,GAAGiB,GAAG,CAACjB,IAAJ,CAASmB,QAAT,CAAkBC,MAArB,CAA4B,CAC1BjC,QAAQ,CAACL,kBAAkB,EAAnB,CAAR,CACAH,KAAK,CAAC0C,GAAN,CAAU,iDAAV,EACCL,IADD,CACM,SAACC,GAAD,CAAS,CACb9B,QAAQ,CAACN,WAAW,CAACoC,GAAG,CAACjB,IAAL,CAAZ,CAAR,CACD,CAHD,EAID,CACF,CAVK,EAUHsB,KAVG,CAUG,SAACC,CAAD,CAAO,CACdrC,mBAAmB,CAAC,OAAD,CAAnB,CACAF,KAAK,CAACwC,eAAN,GACD,CAbK,CAlBiB,uDAAH,kBAAhBpC,CAAAA,gBAAgB,oEAAtB,CAkCA,mBACE,oBAAC,UAAD,EAAY,gBAAgB,CAAEA,gBAA9B,CAAgD,gBAAgB,CAAEH,gBAAlE,EADF,CAGD,CAED,cAAeF,CAAAA,mBAAf","sourcesContent":["import React, {useState} from 'react';\r\nimport CreatePost from './../Components/NewFeed/CreatePost.jsx';\r\nimport axios from 'axios';\r\nimport { useDispatch } from 'react-redux';\r\nimport { addNewStory } from './../Actions/index.jsx';\r\nimport { requestAddNewStory } from './../Actions/index.jsx';\r\n\r\nfunction CreatePostContainer(props){\r\n  const [statusCreatePost, setStatusCreatePost] = useState();\r\n  const dispatch = useDispatch();\r\n\r\n  const submitCreatePost = async (valueEditor, fileList, privacyNewFeed, privacyStory, placeNewFeed, placeStory, listMention) => {\r\n    setStatusCreatePost('loading')\r\n    let mention = [];\r\n    listMention.map(m => {\r\n      mention.push(m.data.mention.id)\r\n    })\r\n    let tags = mention.filter((value, index, mention) => mention.indexOf(value) === index);\r\n    let tag = tags.toString();\r\n\r\n    let data = {\r\n      placeStory: placeStory,\r\n      placePost: placeNewFeed,\r\n      post_Content: valueEditor,\r\n      post_Privacy: privacyNewFeed,\r\n      tag_users_UserId: tag,\r\n      story_Privacy: privacyStory,\r\n      post_images_Url: fileList\r\n    }\r\n    await axios.post('https://www.api.mohi.vn/api/auth/create-post-profile', data).then((res) => {\r\n      setStatusCreatePost('success')\r\n      props.successCreatePost(res.data)\r\n      if(res.data.newStory.length){\r\n        dispatch(requestAddNewStory())\r\n        axios.get(\"https://www.api.mohi.vn/api/auth/get-story-home\")\r\n        .then((res) => {\r\n          dispatch(addNewStory(res.data))\r\n        })\r\n      }\r\n    }).catch((e) => {\r\n      setStatusCreatePost('error')\r\n      props.errorCreatePost()\r\n    })\r\n  }\r\n\r\n  return(\r\n    <CreatePost submitCreatePost={submitCreatePost} statusCreatePost={statusCreatePost}/>\r\n  )\r\n}\r\n\r\nexport default CreatePostContainer;\r\n"]},"metadata":{},"sourceType":"module"}