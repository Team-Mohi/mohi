{"ast":null,"code":"import { Service } from './Service';\nimport query from '../Tasks/Query';\nimport { geojsonToArcGIS } from '../Util';\nexport var FeatureLayerService = Service.extend({\n  options: {\n    idAttribute: 'OBJECTID'\n  },\n  query: function () {\n    return query(this);\n  },\n  addFeature: function (feature, callback, context) {\n    this.addFeatures(feature, callback, context);\n  },\n  addFeatures: function (features, callback, context) {\n    var featuresArray = features.features ? features.features : [features];\n\n    for (var i = featuresArray.length - 1; i >= 0; i--) {\n      delete featuresArray[i].id;\n    }\n\n    features = geojsonToArcGIS(features);\n    features = featuresArray.length > 1 ? features : [features];\n    return this.post('addFeatures', {\n      features: features\n    }, function (error, response) {\n      // For compatibility reason with former addFeature function,\n      // we return the object in the array and not the array itself\n      var result = response && response.addResults ? response.addResults.length > 1 ? response.addResults : response.addResults[0] : undefined;\n\n      if (callback) {\n        callback.call(context, error || response.addResults[0].error, result);\n      }\n    }, context);\n  },\n  updateFeature: function (feature, callback, context) {\n    this.updateFeatures(feature, callback, context);\n  },\n  updateFeatures: function (features, callback, context) {\n    var featuresArray = features.features ? features.features : [features];\n    features = geojsonToArcGIS(features, this.options.idAttribute);\n    features = featuresArray.length > 1 ? features : [features];\n    return this.post('updateFeatures', {\n      features: features\n    }, function (error, response) {\n      // For compatibility reason with former updateFeature function,\n      // we return the object in the array and not the array itself\n      var result = response && response.updateResults ? response.updateResults.length > 1 ? response.updateResults : response.updateResults[0] : undefined;\n\n      if (callback) {\n        callback.call(context, error || response.updateResults[0].error, result);\n      }\n    }, context);\n  },\n  deleteFeature: function (id, callback, context) {\n    this.deleteFeatures(id, callback, context);\n  },\n  deleteFeatures: function (ids, callback, context) {\n    return this.post('deleteFeatures', {\n      objectIds: ids\n    }, function (error, response) {\n      // For compatibility reason with former deleteFeature function,\n      // we return the object in the array and not the array itself\n      var result = response && response.deleteResults ? response.deleteResults.length > 1 ? response.deleteResults : response.deleteResults[0] : undefined;\n\n      if (callback) {\n        callback.call(context, error || response.deleteResults[0].error, result);\n      }\n    }, context);\n  }\n});\nexport function featureLayerService(options) {\n  return new FeatureLayerService(options);\n}\nexport default featureLayerService;","map":{"version":3,"sources":["D:/Web/mohi/client/node_modules/esri-leaflet/src/Services/FeatureLayerService.js"],"names":["Service","query","geojsonToArcGIS","FeatureLayerService","extend","options","idAttribute","addFeature","feature","callback","context","addFeatures","features","featuresArray","i","length","id","post","error","response","result","addResults","undefined","call","updateFeature","updateFeatures","updateResults","deleteFeature","deleteFeatures","ids","objectIds","deleteResults","featureLayerService"],"mappings":"AAAA,SAASA,OAAT,QAAwB,WAAxB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;AACA,SAASC,eAAT,QAAgC,SAAhC;AAEA,OAAO,IAAIC,mBAAmB,GAAGH,OAAO,CAACI,MAAR,CAAe;AAE9CC,EAAAA,OAAO,EAAE;AACPC,IAAAA,WAAW,EAAE;AADN,GAFqC;AAM9CL,EAAAA,KAAK,EAAE,YAAY;AACjB,WAAOA,KAAK,CAAC,IAAD,CAAZ;AACD,GAR6C;AAU9CM,EAAAA,UAAU,EAAE,UAAUC,OAAV,EAAmBC,QAAnB,EAA6BC,OAA7B,EAAsC;AAChD,SAAKC,WAAL,CAAiBH,OAAjB,EAA0BC,QAA1B,EAAoCC,OAApC;AACD,GAZ6C;AAc9CC,EAAAA,WAAW,EAAE,UAAUC,QAAV,EAAoBH,QAApB,EAA8BC,OAA9B,EAAuC;AAClD,QAAIG,aAAa,GAAGD,QAAQ,CAACA,QAAT,GAAoBA,QAAQ,CAACA,QAA7B,GAAwC,CAACA,QAAD,CAA5D;;AACA,SAAK,IAAIE,CAAC,GAAGD,aAAa,CAACE,MAAd,GAAuB,CAApC,EAAuCD,CAAC,IAAI,CAA5C,EAA+CA,CAAC,EAAhD,EAAoD;AAClD,aAAOD,aAAa,CAACC,CAAD,CAAb,CAAiBE,EAAxB;AACD;;AACDJ,IAAAA,QAAQ,GAAGV,eAAe,CAACU,QAAD,CAA1B;AACAA,IAAAA,QAAQ,GAAGC,aAAa,CAACE,MAAd,GAAuB,CAAvB,GAA2BH,QAA3B,GAAsC,CAACA,QAAD,CAAjD;AACA,WAAO,KAAKK,IAAL,CAAU,aAAV,EAAyB;AAC9BL,MAAAA,QAAQ,EAAEA;AADoB,KAAzB,EAEJ,UAAUM,KAAV,EAAiBC,QAAjB,EAA2B;AAC5B;AACA;AACA,UAAIC,MAAM,GAAID,QAAQ,IAAIA,QAAQ,CAACE,UAAtB,GAAoCF,QAAQ,CAACE,UAAT,CAAoBN,MAApB,GAA6B,CAA7B,GAAiCI,QAAQ,CAACE,UAA1C,GAAuDF,QAAQ,CAACE,UAAT,CAAoB,CAApB,CAA3F,GAAoHC,SAAjI;;AACA,UAAIb,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACc,IAAT,CAAcb,OAAd,EAAuBQ,KAAK,IAAIC,QAAQ,CAACE,UAAT,CAAoB,CAApB,EAAuBH,KAAvD,EAA8DE,MAA9D;AACD;AACF,KATM,EASJV,OATI,CAAP;AAUD,GA/B6C;AAiC9Cc,EAAAA,aAAa,EAAE,UAAUhB,OAAV,EAAmBC,QAAnB,EAA6BC,OAA7B,EAAsC;AACnD,SAAKe,cAAL,CAAoBjB,OAApB,EAA6BC,QAA7B,EAAuCC,OAAvC;AACD,GAnC6C;AAqC9Ce,EAAAA,cAAc,EAAE,UAAUb,QAAV,EAAoBH,QAApB,EAA8BC,OAA9B,EAAuC;AACrD,QAAIG,aAAa,GAAGD,QAAQ,CAACA,QAAT,GAAoBA,QAAQ,CAACA,QAA7B,GAAwC,CAACA,QAAD,CAA5D;AACAA,IAAAA,QAAQ,GAAGV,eAAe,CAACU,QAAD,EAAW,KAAKP,OAAL,CAAaC,WAAxB,CAA1B;AACAM,IAAAA,QAAQ,GAAGC,aAAa,CAACE,MAAd,GAAuB,CAAvB,GAA2BH,QAA3B,GAAsC,CAACA,QAAD,CAAjD;AAEA,WAAO,KAAKK,IAAL,CAAU,gBAAV,EAA4B;AACjCL,MAAAA,QAAQ,EAAEA;AADuB,KAA5B,EAEJ,UAAUM,KAAV,EAAiBC,QAAjB,EAA2B;AAC5B;AACA;AACA,UAAIC,MAAM,GAAID,QAAQ,IAAIA,QAAQ,CAACO,aAAtB,GAAuCP,QAAQ,CAACO,aAAT,CAAuBX,MAAvB,GAAgC,CAAhC,GAAoCI,QAAQ,CAACO,aAA7C,GAA6DP,QAAQ,CAACO,aAAT,CAAuB,CAAvB,CAApG,GAAgIJ,SAA7I;;AACA,UAAIb,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACc,IAAT,CAAcb,OAAd,EAAuBQ,KAAK,IAAIC,QAAQ,CAACO,aAAT,CAAuB,CAAvB,EAA0BR,KAA1D,EAAiEE,MAAjE;AACD;AACF,KATM,EASJV,OATI,CAAP;AAUD,GApD6C;AAsD9CiB,EAAAA,aAAa,EAAE,UAAUX,EAAV,EAAcP,QAAd,EAAwBC,OAAxB,EAAiC;AAC9C,SAAKkB,cAAL,CAAoBZ,EAApB,EAAwBP,QAAxB,EAAkCC,OAAlC;AACD,GAxD6C;AA0D9CkB,EAAAA,cAAc,EAAE,UAAUC,GAAV,EAAepB,QAAf,EAAyBC,OAAzB,EAAkC;AAChD,WAAO,KAAKO,IAAL,CAAU,gBAAV,EAA4B;AACjCa,MAAAA,SAAS,EAAED;AADsB,KAA5B,EAEJ,UAAUX,KAAV,EAAiBC,QAAjB,EAA2B;AAC5B;AACA;AACA,UAAIC,MAAM,GAAID,QAAQ,IAAIA,QAAQ,CAACY,aAAtB,GAAuCZ,QAAQ,CAACY,aAAT,CAAuBhB,MAAvB,GAAgC,CAAhC,GAAoCI,QAAQ,CAACY,aAA7C,GAA6DZ,QAAQ,CAACY,aAAT,CAAuB,CAAvB,CAApG,GAAgIT,SAA7I;;AACA,UAAIb,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACc,IAAT,CAAcb,OAAd,EAAuBQ,KAAK,IAAIC,QAAQ,CAACY,aAAT,CAAuB,CAAvB,EAA0Bb,KAA1D,EAAiEE,MAAjE;AACD;AACF,KATM,EASJV,OATI,CAAP;AAUD;AArE6C,CAAf,CAA1B;AAwEP,OAAO,SAASsB,mBAAT,CAA8B3B,OAA9B,EAAuC;AAC5C,SAAO,IAAIF,mBAAJ,CAAwBE,OAAxB,CAAP;AACD;AAED,eAAe2B,mBAAf","sourcesContent":["import { Service } from './Service';\r\nimport query from '../Tasks/Query';\r\nimport { geojsonToArcGIS } from '../Util';\r\n\r\nexport var FeatureLayerService = Service.extend({\r\n\r\n  options: {\r\n    idAttribute: 'OBJECTID'\r\n  },\r\n\r\n  query: function () {\r\n    return query(this);\r\n  },\r\n\r\n  addFeature: function (feature, callback, context) {\r\n    this.addFeatures(feature, callback, context);\r\n  },\r\n\r\n  addFeatures: function (features, callback, context) {\r\n    var featuresArray = features.features ? features.features : [features];\r\n    for (var i = featuresArray.length - 1; i >= 0; i--) {\r\n      delete featuresArray[i].id;\r\n    }\r\n    features = geojsonToArcGIS(features);\r\n    features = featuresArray.length > 1 ? features : [features];\r\n    return this.post('addFeatures', {\r\n      features: features\r\n    }, function (error, response) {\r\n      // For compatibility reason with former addFeature function,\r\n      // we return the object in the array and not the array itself\r\n      var result = (response && response.addResults) ? response.addResults.length > 1 ? response.addResults : response.addResults[0] : undefined;\r\n      if (callback) {\r\n        callback.call(context, error || response.addResults[0].error, result);\r\n      }\r\n    }, context);\r\n  },\r\n\r\n  updateFeature: function (feature, callback, context) {\r\n    this.updateFeatures(feature, callback, context);\r\n  },\r\n\r\n  updateFeatures: function (features, callback, context) {\r\n    var featuresArray = features.features ? features.features : [features];\r\n    features = geojsonToArcGIS(features, this.options.idAttribute);\r\n    features = featuresArray.length > 1 ? features : [features];\r\n\r\n    return this.post('updateFeatures', {\r\n      features: features\r\n    }, function (error, response) {\r\n      // For compatibility reason with former updateFeature function,\r\n      // we return the object in the array and not the array itself\r\n      var result = (response && response.updateResults) ? response.updateResults.length > 1 ? response.updateResults : response.updateResults[0] : undefined;\r\n      if (callback) {\r\n        callback.call(context, error || response.updateResults[0].error, result);\r\n      }\r\n    }, context);\r\n  },\r\n\r\n  deleteFeature: function (id, callback, context) {\r\n    this.deleteFeatures(id, callback, context);\r\n  },\r\n\r\n  deleteFeatures: function (ids, callback, context) {\r\n    return this.post('deleteFeatures', {\r\n      objectIds: ids\r\n    }, function (error, response) {\r\n      // For compatibility reason with former deleteFeature function,\r\n      // we return the object in the array and not the array itself\r\n      var result = (response && response.deleteResults) ? response.deleteResults.length > 1 ? response.deleteResults : response.deleteResults[0] : undefined;\r\n      if (callback) {\r\n        callback.call(context, error || response.deleteResults[0].error, result);\r\n      }\r\n    }, context);\r\n  }\r\n});\r\n\r\nexport function featureLayerService (options) {\r\n  return new FeatureLayerService(options);\r\n}\r\n\r\nexport default featureLayerService;\r\n"]},"metadata":{},"sourceType":"module"}