{"ast":null,"code":"var _jsxFileName = \"D:\\\\Web\\\\mohi\\\\client\\\\src\\\\Components\\\\PresentialModal\\\\ModalUpLoadAvatarProfile.jsx\";\nimport React, { useRef, useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Cropper from 'cropperjs';\nimport 'cropperjs/dist/cropper.css';\nimport { toggleStatusPresentialModal } from './../../Actions/index.jsx';\nimport { responseUpdateAvatar } from './../../Actions/index.jsx';\nimport { requestUpdateAvatar } from './../../Actions/index.jsx';\nimport axios from 'axios';\nimport { WaveLoading } from 'react-loadingg';\n\nfunction ModalUpLoadAvatarProfile({\n  presentialModal,\n  profile\n}) {\n  const {\n    data\n  } = useSelector(state => state.presentialModal);\n  const {\n    loadingUpdateAvatar\n  } = useSelector(state => state.profile);\n  const refCropper = useRef();\n  const dispatch = useDispatch();\n  const [imageX, setImageX] = useState();\n  const [imageY, setImageY] = useState();\n  const [imageW, setImageW] = useState();\n  const [imageH, setImageH] = useState();\n  useEffect(() => {\n    const current = refCropper.current;\n    const cropper = new Cropper(current, {\n      aspectRatio: 1,\n      zoomable: false,\n      scalable: false,\n\n      crop(event) {\n        setImageX(event.detail.x);\n        setImageY(event.detail.y);\n        setImageW(event.detail.width);\n        setImageH(event.detail.height);\n      }\n\n    });\n  }, []);\n\n  const saveAvatar = () => {\n    dispatch(requestUpdateAvatar());\n    const formData = new FormData();\n    formData.append('upload_preset', 'mohi_video');\n    formData.append('file', data);\n    upload(formData);\n  };\n\n  const upload = async formData => {\n    await axios.post('/v1_1/mohi-vn/upload', formData).then(res => {\n      updateDtb(res.data.public_id);\n    });\n  };\n\n  const updateDtb = async img => {\n    await axios.post('https://www.api.mohi.vn/api/auth/update-info-profile', {\n      user_avatar: img,\n      user_avatar_cropX: imageX,\n      user_avatar_cropY: imageY,\n      user_avatar_cropW: imageW,\n      user_avatar_cropH: imageH\n    }).then(() => {\n      dispatch(responseUpdateAvatar({\n        user_avatar: img,\n        user_avatar_cropX: Math.round(imageX),\n        user_avatar_cropY: Math.round(imageY),\n        user_avatar_cropW: Math.round(imageW),\n        user_avatar_cropH: Math.round(imageH)\n      }));\n      dispatch(toggleStatusPresentialModal());\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-custom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"image-cropper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: URL.createObjectURL(data),\n    ref: refCropper,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"action-cropper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => saveAvatar(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 11\n    }\n  }, \"L\\u01B0u\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => dispatch(toggleStatusPresentialModal()),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  }, \"H\\u1EE7y\")), loadingUpdateAvatar && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      background: 'rgba(255,255,255,0.7)',\n      position: 'absolute',\n      width: '100%',\n      height: '100%',\n      top: 0,\n      left: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 34\n    }\n  }, /*#__PURE__*/React.createElement(WaveLoading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 155\n    }\n  }))));\n}\n\nexport default ModalUpLoadAvatarProfile;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/PresentialModal/ModalUpLoadAvatarProfile.jsx"],"names":["React","useRef","useEffect","useState","useSelector","useDispatch","Cropper","toggleStatusPresentialModal","responseUpdateAvatar","requestUpdateAvatar","axios","WaveLoading","ModalUpLoadAvatarProfile","presentialModal","profile","data","state","loadingUpdateAvatar","refCropper","dispatch","imageX","setImageX","imageY","setImageY","imageW","setImageW","imageH","setImageH","current","cropper","aspectRatio","zoomable","scalable","crop","event","detail","x","y","width","height","saveAvatar","formData","FormData","append","upload","post","then","res","updateDtb","public_id","img","user_avatar","user_avatar_cropX","user_avatar_cropY","user_avatar_cropW","user_avatar_cropH","Math","round","URL","createObjectURL","background","position","top","left"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\nimport Cropper from 'cropperjs';\r\nimport 'cropperjs/dist/cropper.css';\r\nimport {toggleStatusPresentialModal} from './../../Actions/index.jsx';\r\nimport {responseUpdateAvatar} from './../../Actions/index.jsx';\r\nimport {requestUpdateAvatar} from './../../Actions/index.jsx';\r\nimport axios from 'axios';\r\nimport { WaveLoading } from 'react-loadingg';\r\n\r\nfunction ModalUpLoadAvatarProfile({presentialModal, profile}){\r\n  const {data} = useSelector(state => state.presentialModal);\r\n  const {loadingUpdateAvatar} = useSelector(state => state.profile);\r\n  const refCropper = useRef();\r\n  const dispatch = useDispatch();\r\n  const [imageX, setImageX] = useState();\r\n  const [imageY, setImageY] = useState();\r\n  const [imageW, setImageW] = useState();\r\n  const [imageH, setImageH] = useState();\r\n\r\n  useEffect(() => {\r\n    const current = refCropper.current;\r\n    const cropper = new Cropper(current, {\r\n      aspectRatio: 1,\r\n      zoomable: false,\r\n      scalable: false,\r\n      crop(event) {\r\n        setImageX(event.detail.x)\r\n        setImageY(event.detail.y)\r\n        setImageW(event.detail.width)\r\n        setImageH(event.detail.height)\r\n      },\r\n    });\r\n  }, [])\r\n\r\n  const saveAvatar = () => {\r\n    dispatch(requestUpdateAvatar())\r\n\r\n    const formData = new FormData();\r\n    formData.append('upload_preset', 'mohi_video');\r\n    formData.append('file', data);\r\n    upload(formData)\r\n  }\r\n\r\n  const upload = async (formData) => {\r\n    await axios.post('/v1_1/mohi-vn/upload', formData)\r\n    .then((res) => {\r\n      updateDtb(res.data.public_id)\r\n    })\r\n  }\r\n\r\n  const updateDtb = async (img) => {\r\n    await axios.post('https://www.api.mohi.vn/api/auth/update-info-profile', {\r\n      user_avatar: img,\r\n      user_avatar_cropX: imageX,\r\n      user_avatar_cropY: imageY,\r\n      user_avatar_cropW: imageW,\r\n      user_avatar_cropH: imageH,\r\n    }).then(() => {\r\n      dispatch(responseUpdateAvatar({\r\n        user_avatar: img,\r\n        user_avatar_cropX: Math.round(imageX),\r\n        user_avatar_cropY: Math.round(imageY),\r\n        user_avatar_cropW: Math.round(imageW),\r\n        user_avatar_cropH: Math.round(imageH),\r\n      }))\r\n      dispatch(toggleStatusPresentialModal())\r\n    })\r\n  }\r\n  return(\r\n    <React.Fragment>\r\n      <div className=\"modal-custom\">\r\n        <div className=\"image-cropper\">\r\n          <img src={URL.createObjectURL(data)} ref={refCropper} alt=\"\" />\r\n        </div>\r\n        <div className=\"action-cropper\">\r\n          <button onClick={() => saveAvatar()}>Lưu</button>\r\n          <button onClick={() => dispatch(toggleStatusPresentialModal())}>Hủy</button>\r\n        </div>\r\n        { loadingUpdateAvatar && <div style={{background: 'rgba(255,255,255,0.7)', position: 'absolute', width: '100%', height: '100%', top: 0, left: 0}}><WaveLoading /></div>}\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default ModalUpLoadAvatarProfile;\r\n"]},"metadata":{},"sourceType":"module"}