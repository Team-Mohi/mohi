{"ast":null,"code":"import { Util } from 'leaflet';\nimport { RasterLayer } from './RasterLayer';\nimport { getUrlParams } from '../Util';\nimport imageService from '../Services/ImageService';\nexport var ImageMapLayer = RasterLayer.extend({\n  options: {\n    updateInterval: 150,\n    format: 'jpgpng',\n    transparent: true,\n    f: 'image'\n  },\n  query: function () {\n    return this.service.query();\n  },\n  identify: function () {\n    return this.service.identify();\n  },\n  initialize: function (options) {\n    options = getUrlParams(options);\n    this.service = imageService(options);\n    this.service.addEventParent(this);\n    Util.setOptions(this, options);\n  },\n  setPixelType: function (pixelType) {\n    this.options.pixelType = pixelType;\n\n    this._update();\n\n    return this;\n  },\n  getPixelType: function () {\n    return this.options.pixelType;\n  },\n  setBandIds: function (bandIds) {\n    if (Util.isArray(bandIds)) {\n      this.options.bandIds = bandIds.join(',');\n    } else {\n      this.options.bandIds = bandIds.toString();\n    }\n\n    this._update();\n\n    return this;\n  },\n  getBandIds: function () {\n    return this.options.bandIds;\n  },\n  setNoData: function (noData, noDataInterpretation) {\n    if (Util.isArray(noData)) {\n      this.options.noData = noData.join(',');\n    } else {\n      this.options.noData = noData.toString();\n    }\n\n    if (noDataInterpretation) {\n      this.options.noDataInterpretation = noDataInterpretation;\n    }\n\n    this._update();\n\n    return this;\n  },\n  getNoData: function () {\n    return this.options.noData;\n  },\n  getNoDataInterpretation: function () {\n    return this.options.noDataInterpretation;\n  },\n  setRenderingRule: function (renderingRule) {\n    this.options.renderingRule = renderingRule;\n\n    this._update();\n  },\n  getRenderingRule: function () {\n    return this.options.renderingRule;\n  },\n  setMosaicRule: function (mosaicRule) {\n    this.options.mosaicRule = mosaicRule;\n\n    this._update();\n  },\n  getMosaicRule: function () {\n    return this.options.mosaicRule;\n  },\n  _getPopupData: function (e) {\n    var callback = Util.bind(function (error, results, response) {\n      if (error) {\n        return;\n      } // we really can't do anything here but authenticate or requesterror will fire\n\n\n      setTimeout(Util.bind(function () {\n        this._renderPopup(e.latlng, error, results, response);\n      }, this), 300);\n    }, this);\n    var identifyRequest = this.identify().at(e.latlng); // set mosaic rule for identify task if it is set for layer\n\n    if (this.options.mosaicRule) {\n      identifyRequest.setMosaicRule(this.options.mosaicRule); // @TODO: force return catalog items too?\n    } // @TODO: set rendering rule? Not sure,\n    // sometimes you want raw pixel values\n    // if (this.options.renderingRule) {\n    //   identifyRequest.setRenderingRule(this.options.renderingRule);\n    // }\n\n\n    identifyRequest.run(callback); // set the flags to show the popup\n\n    this._shouldRenderPopup = true;\n    this._lastClick = e.latlng;\n  },\n  _buildExportParams: function () {\n    var sr = parseInt(this._map.options.crs.code.split(':')[1], 10);\n    var params = {\n      bbox: this._calculateBbox(),\n      size: this._calculateImageSize(),\n      format: this.options.format,\n      transparent: this.options.transparent,\n      bboxSR: sr,\n      imageSR: sr\n    };\n\n    if (this.options.from && this.options.to) {\n      params.time = this.options.from.valueOf() + ',' + this.options.to.valueOf();\n    }\n\n    if (this.options.pixelType) {\n      params.pixelType = this.options.pixelType;\n    }\n\n    if (this.options.interpolation) {\n      params.interpolation = this.options.interpolation;\n    }\n\n    if (this.options.compressionQuality) {\n      params.compressionQuality = this.options.compressionQuality;\n    }\n\n    if (this.options.bandIds) {\n      params.bandIds = this.options.bandIds;\n    } // 0 is falsy *and* a valid input parameter\n\n\n    if (this.options.noData === 0 || this.options.noData) {\n      params.noData = this.options.noData;\n    }\n\n    if (this.options.noDataInterpretation) {\n      params.noDataInterpretation = this.options.noDataInterpretation;\n    }\n\n    if (this.service.options.token) {\n      params.token = this.service.options.token;\n    }\n\n    if (this.options.renderingRule) {\n      params.renderingRule = JSON.stringify(this.options.renderingRule);\n    }\n\n    if (this.options.mosaicRule) {\n      params.mosaicRule = JSON.stringify(this.options.mosaicRule);\n    }\n\n    return params;\n  },\n  _requestExport: function (params, bounds) {\n    if (this.options.f === 'json') {\n      this.service.request('exportImage', params, function (error, response) {\n        if (error) {\n          return;\n        } // we really can't do anything here but authenticate or requesterror will fire\n\n\n        if (this.options.token) {\n          response.href += '?token=' + this.options.token;\n        }\n\n        if (this.options.proxy) {\n          response.href = this.options.proxy + '?' + response.href;\n        }\n\n        this._renderImage(response.href, bounds);\n      }, this);\n    } else {\n      params.f = 'image';\n      var fullUrl = this.options.url + 'exportImage' + Util.getParamString(params);\n\n      if (this.options.proxy) {\n        fullUrl = this.options.proxy + '?' + fullUrl;\n      }\n\n      this._renderImage(fullUrl, bounds);\n    }\n  }\n});\nexport function imageMapLayer(url, options) {\n  return new ImageMapLayer(url, options);\n}\nexport default imageMapLayer;","map":{"version":3,"sources":["D:/Web/mohi/client/node_modules/esri-leaflet/src/Layers/ImageMapLayer.js"],"names":["Util","RasterLayer","getUrlParams","imageService","ImageMapLayer","extend","options","updateInterval","format","transparent","f","query","service","identify","initialize","addEventParent","setOptions","setPixelType","pixelType","_update","getPixelType","setBandIds","bandIds","isArray","join","toString","getBandIds","setNoData","noData","noDataInterpretation","getNoData","getNoDataInterpretation","setRenderingRule","renderingRule","getRenderingRule","setMosaicRule","mosaicRule","getMosaicRule","_getPopupData","e","callback","bind","error","results","response","setTimeout","_renderPopup","latlng","identifyRequest","at","run","_shouldRenderPopup","_lastClick","_buildExportParams","sr","parseInt","_map","crs","code","split","params","bbox","_calculateBbox","size","_calculateImageSize","bboxSR","imageSR","from","to","time","valueOf","interpolation","compressionQuality","token","JSON","stringify","_requestExport","bounds","request","href","proxy","_renderImage","fullUrl","url","getParamString","imageMapLayer"],"mappings":"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","sourcesContent":["import { Util } from 'leaflet';\r\nimport { RasterLayer } from './RasterLayer';\r\nimport { getUrlParams } from '../Util';\r\nimport imageService from '../Services/ImageService';\r\n\r\nexport var ImageMapLayer = RasterLayer.extend({\r\n\r\n  options: {\r\n    updateInterval: 150,\r\n    format: 'jpgpng',\r\n    transparent: true,\r\n    f: 'image'\r\n  },\r\n\r\n  query: function () {\r\n    return this.service.query();\r\n  },\r\n\r\n  identify: function () {\r\n    return this.service.identify();\r\n  },\r\n\r\n  initialize: function (options) {\r\n    options = getUrlParams(options);\r\n    this.service = imageService(options);\r\n    this.service.addEventParent(this);\r\n\r\n    Util.setOptions(this, options);\r\n  },\r\n\r\n  setPixelType: function (pixelType) {\r\n    this.options.pixelType = pixelType;\r\n    this._update();\r\n    return this;\r\n  },\r\n\r\n  getPixelType: function () {\r\n    return this.options.pixelType;\r\n  },\r\n\r\n  setBandIds: function (bandIds) {\r\n    if (Util.isArray(bandIds)) {\r\n      this.options.bandIds = bandIds.join(',');\r\n    } else {\r\n      this.options.bandIds = bandIds.toString();\r\n    }\r\n    this._update();\r\n    return this;\r\n  },\r\n\r\n  getBandIds: function () {\r\n    return this.options.bandIds;\r\n  },\r\n\r\n  setNoData: function (noData, noDataInterpretation) {\r\n    if (Util.isArray(noData)) {\r\n      this.options.noData = noData.join(',');\r\n    } else {\r\n      this.options.noData = noData.toString();\r\n    }\r\n    if (noDataInterpretation) {\r\n      this.options.noDataInterpretation = noDataInterpretation;\r\n    }\r\n    this._update();\r\n    return this;\r\n  },\r\n\r\n  getNoData: function () {\r\n    return this.options.noData;\r\n  },\r\n\r\n  getNoDataInterpretation: function () {\r\n    return this.options.noDataInterpretation;\r\n  },\r\n\r\n  setRenderingRule: function (renderingRule) {\r\n    this.options.renderingRule = renderingRule;\r\n    this._update();\r\n  },\r\n\r\n  getRenderingRule: function () {\r\n    return this.options.renderingRule;\r\n  },\r\n\r\n  setMosaicRule: function (mosaicRule) {\r\n    this.options.mosaicRule = mosaicRule;\r\n    this._update();\r\n  },\r\n\r\n  getMosaicRule: function () {\r\n    return this.options.mosaicRule;\r\n  },\r\n\r\n  _getPopupData: function (e) {\r\n    var callback = Util.bind(function (error, results, response) {\r\n      if (error) { return; } // we really can't do anything here but authenticate or requesterror will fire\r\n      setTimeout(Util.bind(function () {\r\n        this._renderPopup(e.latlng, error, results, response);\r\n      }, this), 300);\r\n    }, this);\r\n\r\n    var identifyRequest = this.identify().at(e.latlng);\r\n\r\n    // set mosaic rule for identify task if it is set for layer\r\n    if (this.options.mosaicRule) {\r\n      identifyRequest.setMosaicRule(this.options.mosaicRule);\r\n      // @TODO: force return catalog items too?\r\n    }\r\n\r\n    // @TODO: set rendering rule? Not sure,\r\n    // sometimes you want raw pixel values\r\n    // if (this.options.renderingRule) {\r\n    //   identifyRequest.setRenderingRule(this.options.renderingRule);\r\n    // }\r\n\r\n    identifyRequest.run(callback);\r\n\r\n    // set the flags to show the popup\r\n    this._shouldRenderPopup = true;\r\n    this._lastClick = e.latlng;\r\n  },\r\n\r\n  _buildExportParams: function () {\r\n    var sr = parseInt(this._map.options.crs.code.split(':')[1], 10);\r\n\r\n    var params = {\r\n      bbox: this._calculateBbox(),\r\n      size: this._calculateImageSize(),\r\n      format: this.options.format,\r\n      transparent: this.options.transparent,\r\n      bboxSR: sr,\r\n      imageSR: sr\r\n    };\r\n\r\n    if (this.options.from && this.options.to) {\r\n      params.time = this.options.from.valueOf() + ',' + this.options.to.valueOf();\r\n    }\r\n\r\n    if (this.options.pixelType) {\r\n      params.pixelType = this.options.pixelType;\r\n    }\r\n\r\n    if (this.options.interpolation) {\r\n      params.interpolation = this.options.interpolation;\r\n    }\r\n\r\n    if (this.options.compressionQuality) {\r\n      params.compressionQuality = this.options.compressionQuality;\r\n    }\r\n\r\n    if (this.options.bandIds) {\r\n      params.bandIds = this.options.bandIds;\r\n    }\r\n\r\n    // 0 is falsy *and* a valid input parameter\r\n    if (this.options.noData === 0 || this.options.noData) {\r\n      params.noData = this.options.noData;\r\n    }\r\n\r\n    if (this.options.noDataInterpretation) {\r\n      params.noDataInterpretation = this.options.noDataInterpretation;\r\n    }\r\n\r\n    if (this.service.options.token) {\r\n      params.token = this.service.options.token;\r\n    }\r\n\r\n    if (this.options.renderingRule) {\r\n      params.renderingRule = JSON.stringify(this.options.renderingRule);\r\n    }\r\n\r\n    if (this.options.mosaicRule) {\r\n      params.mosaicRule = JSON.stringify(this.options.mosaicRule);\r\n    }\r\n\r\n    return params;\r\n  },\r\n\r\n  _requestExport: function (params, bounds) {\r\n    if (this.options.f === 'json') {\r\n      this.service.request('exportImage', params, function (error, response) {\r\n        if (error) { return; } // we really can't do anything here but authenticate or requesterror will fire\r\n        if (this.options.token) {\r\n          response.href += ('?token=' + this.options.token);\r\n        }\r\n        if (this.options.proxy) {\r\n          response.href = this.options.proxy + '?' + response.href;\r\n        }\r\n        this._renderImage(response.href, bounds);\r\n      }, this);\r\n    } else {\r\n      params.f = 'image';\r\n      var fullUrl = this.options.url + 'exportImage' + Util.getParamString(params);\r\n      if (this.options.proxy) {\r\n        fullUrl = this.options.proxy + '?' + fullUrl;\r\n      }\r\n      this._renderImage(fullUrl, bounds);\r\n    }\r\n  }\r\n});\r\n\r\nexport function imageMapLayer (url, options) {\r\n  return new ImageMapLayer(url, options);\r\n}\r\n\r\nexport default imageMapLayer;\r\n"]},"metadata":{},"sourceType":"module"}