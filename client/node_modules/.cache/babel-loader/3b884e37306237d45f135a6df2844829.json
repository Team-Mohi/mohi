{"ast":null,"code":"var _jsxFileName = \"D:\\\\Web\\\\mohi\\\\client\\\\src\\\\Components\\\\Messenger\\\\index.jsx\";\nimport React, { useEffect, useState, useRef, Suspense } from 'react';\nimport './messenger.css';\nimport { BsSearch, BsFillCameraVideoFill, BsThreeDotsVertical, BsImage, BsPencilSquare } from 'react-icons/bs';\nimport { AiTwotoneSetting, AiTwotoneLike, AiFillFile, AiFillCamera, AiFillCloseCircle } from 'react-icons/ai';\nimport { Link, Route, Switch, useHistory } from 'react-router-dom';\nimport { Image, Transformation } from 'cloudinary-react';\nimport useWindowSize from \"./useWindowSize.jsx\";\nimport { ContentMessenger } from \"./ContentMessenger.jsx\";\nimport { Row } from 'antd';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { searchFriendProfile } from './../../Actions/index.jsx';\nimport moment from 'moment';\n\nfunction Messenger(props, {\n  message\n}) {\n  const {\n    list\n  } = useSelector(state => state.message);\n  const dispatch = useDispatch();\n  const heightScrollSider = window.innerHeight - 190;\n  const history = useHistory();\n  const windowSize = useWindowSize();\n  const [showScroll, setShowScroll] = useState({\n    height: heightScrollSider\n  });\n  const [contentChat, setContentChat] = useState(false);\n  moment.updateLocale('en', {\n    relativeTime: {\n      future: \"%s\",\n      past: \"%s\",\n      s: 'vài giây',\n      ss: '%d phút',\n      m: \"1 phút\",\n      mm: \"%d phút\",\n      h: \"%d giờ\",\n      hh: \"%d giờ\",\n      d: \"một ngày\",\n      dd: \"%d ngày\",\n      w: \"một tuần\",\n      ww: \"%d tuần\",\n      M: \"một tháng\",\n      MM: \"%d tháng\",\n      y: \"một năm\",\n      yy: \"%d năm\"\n    }\n  });\n  useEffect(() => {\n    setShowScroll({\n      height: heightScrollSider\n    });\n  }, [windowSize]);\n\n  const openContentChat = idUser => {\n    history.push('/messenger/' + idUser);\n  };\n\n  const getMessageOneUser = idUser => {\n    props.getMessageOneUser(idUser);\n  };\n\n  const SiderMessenger = ({\n    friends\n  }) => {\n    const listFriends = useSelector(state => state.friends.list);\n    const searchKeyWords = useSelector(state => state.friends.searchKeyWords);\n    const [scrollSider, setScrollSider] = useState();\n    const sider = useRef();\n    const currentUser = JSON.parse(localStorage.getItem('ustk')).info;\n\n    function handleSiderScroll() {\n      const {\n        scrollTop\n      } = sider.current;\n      if (scrollTop > 0 && !scrollSider) setScrollSider({\n        boxShadow: '-4px 0.1px 3px rgba(0,0,0,0.2)'\n      });\n      if (scrollTop === 0) setScrollSider({});\n    }\n\n    const onChangeSearchFriend = e => {\n      dispatch(searchFriendProfile(e.target.value));\n    };\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-head\",\n      style: scrollSider,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-title-left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-avatar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }\n    }, currentUser.user_avatar_cropX === null ? /*#__PURE__*/React.createElement(\"img\", {\n      src: currentUser.user_avatar,\n      alt: currentUser.user_first_name + ' ' + currentUser.user_last_name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 21\n      }\n    }) : /*#__PURE__*/React.createElement(Image, {\n      cloudName: \"mohi-vn\",\n      publicId: currentUser.user_avatar + \".jpg\",\n      version: \"1607061343\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Transformation, {\n      height: currentUser.user_avatar_cropH,\n      width: currentUser.user_avatar_cropW,\n      x: currentUser.user_avatar_cropX,\n      y: currentUser.user_avatar_cropY,\n      crop: \"crop\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }\n    }, \"Chat\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-title-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-search\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(BsSearch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"T\\xECm ki\\u1EBFm tr\\xEAn Messenger\",\n      onChange: onChangeSearchFriend,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-list-user-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sider-messenger-list-user\",\n      style: showScroll,\n      onScroll: () => handleSiderScroll(),\n      ref: sider,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 15\n      }\n    }, !list.length && /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        textAlign: 'center'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 34\n      }\n    }, \"T\\xECm ki\\u1EBFm b\\u1EA1n b\\xE8 \\u0111\\u1EC3 nh\\u1EAFn tin\"), list.map((mess, index) => {\n      return /*#__PURE__*/React.createElement(\"li\", {\n        key: index,\n        onClick: () => openContentChat(mess.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-user-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-user-item-avatar\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }\n      }, mess.user_avatar_cropX === null ? /*#__PURE__*/React.createElement(\"img\", {\n        src: mess.user_avatar,\n        alt: mess.user_last_name,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 29\n        }\n      }) : /*#__PURE__*/React.createElement(Image, {\n        cloudName: \"mohi-vn\",\n        publicId: mess.user_avatar + \".jpg\",\n        version: \"1607061343\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(Transformation, {\n        height: mess.user_avatar_cropH,\n        width: mess.user_avatar_cropW,\n        x: mess.user_avatar_cropX,\n        y: mess.user_avatar_cropY,\n        crop: \"crop\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 31\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-username\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 27\n        }\n      }, mess.user_first_name + ' ' + mess.user_last_name), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-content-nearest\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 27\n        }\n      }, mess.pivot.messages_Message)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-time-send\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 25\n        }\n      }, moment(mess.pivot.created_at, \"YYYYMMDD\\h:m:s\").fromNow())), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sider-messenger-user-item-status\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 23\n        }\n      }));\n    })))));\n  };\n\n  const ChatHello = () => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content-messenger-container content-hello\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }\n    }, \"MOHI\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }\n    }, \"Xin ch\\xE0o b\\u1EA1n\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }\n    }, \"H\\xE3y nh\\u1EAFn tin cho b\\u1EA1n b\\xE8 \\u0111i n\\xE0o\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"messenger-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(SiderMessenger, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/messenger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ChatHello, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 31\n      }\n    }, \"loading\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    path: \"/messenger/:idUser\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ContentMessenger, {\n    getMessageOneUser: getMessageOneUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 13\n    }\n  })))));\n}\n\nexport default Messenger;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/Messenger/index.jsx"],"names":["React","useEffect","useState","useRef","Suspense","BsSearch","BsFillCameraVideoFill","BsThreeDotsVertical","BsImage","BsPencilSquare","AiTwotoneSetting","AiTwotoneLike","AiFillFile","AiFillCamera","AiFillCloseCircle","Link","Route","Switch","useHistory","Image","Transformation","useWindowSize","ContentMessenger","Row","useSelector","useDispatch","searchFriendProfile","moment","Messenger","props","message","list","state","dispatch","heightScrollSider","window","innerHeight","history","windowSize","showScroll","setShowScroll","height","contentChat","setContentChat","updateLocale","relativeTime","future","past","s","ss","m","mm","h","hh","d","dd","w","ww","M","MM","y","yy","openContentChat","idUser","push","getMessageOneUser","SiderMessenger","friends","listFriends","searchKeyWords","scrollSider","setScrollSider","sider","currentUser","JSON","parse","localStorage","getItem","info","handleSiderScroll","scrollTop","current","boxShadow","onChangeSearchFriend","e","target","value","user_avatar_cropX","user_avatar","user_first_name","user_last_name","user_avatar_cropH","user_avatar_cropW","user_avatar_cropY","length","textAlign","map","mess","index","id","pivot","messages_Message","created_at","fromNow","ChatHello"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useRef, Suspense} from 'react';\r\nimport './messenger.css';\r\nimport {BsSearch, BsFillCameraVideoFill, BsThreeDotsVertical, BsImage, BsPencilSquare} from 'react-icons/bs';\r\nimport {AiTwotoneSetting, AiTwotoneLike, AiFillFile, AiFillCamera, AiFillCloseCircle} from 'react-icons/ai';\r\nimport {Link, Route, Switch, useHistory} from 'react-router-dom';\r\nimport {Image,Transformation} from 'cloudinary-react';\r\nimport useWindowSize from \"./useWindowSize.jsx\";\r\nimport {ContentMessenger} from \"./ContentMessenger.jsx\";\r\nimport {Row} from 'antd';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\nimport {searchFriendProfile} from './../../Actions/index.jsx';\r\nimport moment from 'moment';\r\n\r\nfunction Messenger(props, { message }){\r\n  const {list} = useSelector(state => state.message);\r\n  const dispatch = useDispatch();\r\n  const heightScrollSider = window.innerHeight - 190;\r\n  const history = useHistory();\r\n  const windowSize = useWindowSize();\r\n  const [showScroll, setShowScroll] = useState({height: heightScrollSider})\r\n  const [contentChat, setContentChat] = useState(false)\r\n  moment.updateLocale('en', {\r\n    relativeTime : {\r\n        future: \"%s\",\r\n        past:   \"%s\",\r\n        s  : 'vài giây',\r\n        ss : '%d phút',\r\n        m:  \"1 phút\",\r\n        mm: \"%d phút\",\r\n        h:  \"%d giờ\",\r\n        hh: \"%d giờ\",\r\n        d:  \"một ngày\",\r\n        dd: \"%d ngày\",\r\n        w:  \"một tuần\",\r\n        ww: \"%d tuần\",\r\n        M:  \"một tháng\",\r\n        MM: \"%d tháng\",\r\n        y:  \"một năm\",\r\n        yy: \"%d năm\"\r\n    }\r\n  });\r\n  useEffect(() => {\r\n    setShowScroll({height: heightScrollSider})\r\n  },[windowSize]);\r\n\r\n  const openContentChat = (idUser) => {\r\n    history.push('/messenger/' + idUser)\r\n  }\r\n\r\n  const getMessageOneUser = (idUser) => {\r\n    props.getMessageOneUser(idUser)\r\n  }\r\n\r\n  const SiderMessenger = ({ friends }) => {\r\n    const listFriends = useSelector(state => state.friends.list);\r\n    const searchKeyWords = useSelector(state => state.friends.searchKeyWords);\r\n    const [scrollSider, setScrollSider] = useState();\r\n    const sider = useRef();\r\n    const currentUser = JSON.parse(localStorage.getItem('ustk')).info;\r\n\r\n    function handleSiderScroll(){\r\n      const {scrollTop} = sider.current;\r\n      if(scrollTop > 0 && !scrollSider) setScrollSider({boxShadow: '-4px 0.1px 3px rgba(0,0,0,0.2)'})\r\n      if(scrollTop === 0) setScrollSider({})\r\n    }\r\n\r\n    const onChangeSearchFriend = (e) => {\r\n      dispatch(searchFriendProfile(e.target.value))\r\n    }\r\n\r\n      return(\r\n        <div className=\"sider-messenger-container\">\r\n          <div className=\"sider-messenger-head\" style={scrollSider}>\r\n            <div className=\"sider-messenger-title\">\r\n              <div className=\"sider-messenger-title-left\">\r\n                <div className=\"sider-messenger-avatar\">\r\n                  {currentUser.user_avatar_cropX === null ?\r\n                    <img src={currentUser.user_avatar} alt={currentUser.user_first_name + ' ' + currentUser.user_last_name} />\r\n                    :\r\n                    <Image cloudName=\"mohi-vn\" publicId={currentUser.user_avatar+ \".jpg\"} version=\"1607061343\">\r\n                      <Transformation height={currentUser.user_avatar_cropH}  width={currentUser.user_avatar_cropW} x={currentUser.user_avatar_cropX} y={currentUser.user_avatar_cropY} crop=\"crop\" />\r\n                    </Image>\r\n                  }\r\n                </div>\r\n                <span>Chat</span>\r\n              </div>\r\n              <div className=\"sider-messenger-title-right\">\r\n              </div>\r\n            </div>\r\n            <div className=\"sider-messenger-search\">\r\n              <BsSearch />\r\n            <input type=\"text\" placeholder=\"Tìm kiếm trên Messenger\" onChange={onChangeSearchFriend}/>\r\n            </div>\r\n          </div>\r\n          <div className=\"sider-messenger-list-user-container\" >\r\n            <div className=\"sider-messenger-list-user\" style={showScroll} onScroll={() => handleSiderScroll()} ref={sider}>\r\n              <ul>\r\n                {!list.length && <div style={{textAlign: 'center'}}>Tìm kiếm bạn bè để nhắn tin</div>}\r\n                {list.map((mess, index) => {\r\n                  return(\r\n                    <li key={index} onClick={() => openContentChat(mess.id)}>\r\n                      <div className=\"sider-messenger-user-item\">\r\n                        <div className=\"sider-messenger-user-item-avatar\">\r\n                          {mess.user_avatar_cropX === null ?\r\n                            <img src={mess.user_avatar} alt={mess.user_last_name} />\r\n                            :\r\n                            <Image cloudName=\"mohi-vn\" publicId={mess.user_avatar+ \".jpg\"} version=\"1607061343\">\r\n                              <Transformation height={mess.user_avatar_cropH}  width={mess.user_avatar_cropW} x={mess.user_avatar_cropX} y={mess.user_avatar_cropY} crop=\"crop\" />\r\n                            </Image>\r\n                          }\r\n                        </div>\r\n                        <div className=\"sider-messenger-content\">\r\n                          <div className=\"sider-messenger-username\">\r\n                            {mess.user_first_name + ' ' + mess.user_last_name}\r\n                          </div>\r\n                          <div className=\"sider-messenger-content-nearest\">\r\n                            {mess.pivot.messages_Message}\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"sider-messenger-time-send\">\r\n                          {moment(mess.pivot.created_at, \"YYYYMMDD\\h:m:s\").fromNow()}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"sider-messenger-user-item-status\">\r\n                      </div>\r\n                    </li>\r\n                  )\r\n                })}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n  }\r\n\r\n  const ChatHello = () => {\r\n    return(\r\n      <div className=\"content-messenger-container content-hello\">\r\n        <p>MOHI</p>\r\n        <p>Xin chào bạn</p>\r\n        <p>Hãy nhắn tin cho bạn bè đi nào</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return(\r\n      <div className=\"messenger-container\">\r\n        <SiderMessenger />\r\n        <Switch>\r\n          <Route exact path=\"/messenger\">\r\n            <ChatHello />\r\n          </Route>\r\n          <Suspense fallback={<div>loading</div>} >\r\n          <Route path=\"/messenger/:idUser\">\r\n            <ContentMessenger getMessageOneUser={getMessageOneUser}/>\r\n          </Route>\r\n          </Suspense>\r\n        </Switch>\r\n      </div>\r\n  )\r\n}\r\n\r\nexport default Messenger;\r\n"]},"metadata":{},"sourceType":"module"}