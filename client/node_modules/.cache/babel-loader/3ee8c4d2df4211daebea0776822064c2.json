{"ast":null,"code":"import _toConsumableArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./UploadMuti.css';import{FiPlus}from\"react-icons/fi\";import{AiOutlineClose}from\"react-icons/ai\";import axios from'axios';import{Spin}from'antd';function UploadMuti(props){var _useState=useState(props.imagesPost),_useState2=_slicedToArray(_useState,2),files=_useState2[0],setFiles=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),listLoading=_useState4[0],setListLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];useEffect(function(){if(props.statusCreatePost&&props.statusCreatePost!=='loading'){setFiles([]);}},[props.statusCreatePost]);var onChange=function onChange(e){var arrLoading=[];Array.from(e.target.files).map(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file,index){var formData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:arrLoading.push(index);setListLoading(arrLoading);setLoading(true);formData=new FormData();formData.append('upload_preset','mohi_video');formData.append('file',file);upload(formData);case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());};var upload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(formData){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/v1_1/mohi-vn/upload',formData).then(function(res){files.push(res.data);}).then(function(){setListLoading([]);setLoading(false);props.uploadMuti(files);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function upload(_x3){return _ref2.apply(this,arguments);};}();var deleteFile=function deleteFile(index){var newFile=_toConsumableArray(files);newFile.splice(index,1);setFiles(newFile);props.uploadMuti(newFile);};var renderFile=function renderFile(source){return/*#__PURE__*/React.createElement(React.Fragment,null,source.map(function(photo,index){if(photo.post_images_Type){if(photo.post_images_Type==='image'){return/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item\",key:index},/*#__PURE__*/React.createElement(\"img\",{src:photo.post_images_Url}),/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item-presential \"+index},/*#__PURE__*/React.createElement(AiOutlineClose,{onClick:function onClick(){return deleteFile(index);}})));}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item video-item\",key:index},/*#__PURE__*/React.createElement(\"video\",null,/*#__PURE__*/React.createElement(\"source\",{src:photo.post_images_Url}),\"Your browser does not support HTML5 video.\"),/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item-presential \"+index},/*#__PURE__*/React.createElement(AiOutlineClose,{onClick:function onClick(){return deleteFile(index);}})));}}else{if(photo.resource_type==='image'){return/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item\",key:index},/*#__PURE__*/React.createElement(\"img\",{src:photo.secure_url}),/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item-presential \"+index},/*#__PURE__*/React.createElement(AiOutlineClose,{onClick:function onClick(){return deleteFile(index);}})));}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item video-item\",key:index},/*#__PURE__*/React.createElement(\"video\",null,/*#__PURE__*/React.createElement(\"source\",{src:photo.secure_url}),\"Your browser does not support HTML5 video.\"),/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-item-presential \"+index},/*#__PURE__*/React.createElement(AiOutlineClose,{onClick:function onClick(){return deleteFile(index);}})));}}}),loading?/*#__PURE__*/React.createElement(React.Fragment,null,listLoading.map(function(load,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-next-item\",key:index},/*#__PURE__*/React.createElement(Spin,null));})):null,/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-next-item\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"update_post_upload_image\"},/*#__PURE__*/React.createElement(FiPlus,null))));};return/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"list-preview\"},renderFile(files))),/*#__PURE__*/React.createElement(\"input\",{id:\"update_post_upload_image\",type:\"file\",multiple:true,onChange:onChange,accept:\"image/*,video/*\"}));}export default UploadMuti;","map":{"version":3,"sources":["D:/Web/mohi/client/src/Components/PresentialModal/UploadMuti.jsx"],"names":["React","useState","useEffect","FiPlus","AiOutlineClose","axios","Spin","UploadMuti","props","imagesPost","files","setFiles","listLoading","setListLoading","loading","setLoading","statusCreatePost","onChange","e","arrLoading","Array","from","target","map","file","index","push","formData","FormData","append","upload","post","then","res","data","uploadMuti","deleteFile","newFile","splice","renderFile","source","photo","post_images_Type","post_images_Url","resource_type","secure_url","load"],"mappings":"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","sourcesContent":["import React, { useState, useEffect} from 'react';\r\nimport './UploadMuti.css';\r\nimport { FiPlus } from \"react-icons/fi\";\r\nimport { AiOutlineClose } from \"react-icons/ai\";\r\nimport axios from 'axios';\r\nimport { Spin } from 'antd';\r\n\r\nfunction UploadMuti(props){\r\n  const [files, setFiles] = useState(props.imagesPost);\r\n  const [listLoading, setListLoading] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if(props.statusCreatePost && props.statusCreatePost !== 'loading'){\r\n      setFiles([])\r\n    }\r\n  }, [props.statusCreatePost])\r\n\r\n  const onChange = (e) => {\r\n    let arrLoading = [];\r\n\r\n      Array.from(e.target.files).map( async (file, index) => {\r\n        arrLoading.push(index)\r\n        setListLoading(arrLoading)\r\n        setLoading(true);\r\n\r\n        const formData = new FormData();\r\n        formData.append('upload_preset', 'mohi_video');\r\n        formData.append('file', file);\r\n        upload(formData)\r\n\r\n      })\r\n  }\r\n\r\n  const upload = async (formData) => {\r\n    await axios.post('/v1_1/mohi-vn/upload', formData)\r\n    .then((res) => {\r\n      files.push(res.data)\r\n    }).then(() =>{\r\n      setListLoading([])\r\n      setLoading(false);\r\n      props.uploadMuti(files)\r\n    })\r\n  }\r\n\r\n  const deleteFile = (index) => {\r\n    const newFile = [...files]\r\n    newFile.splice(index, 1)\r\n    setFiles(newFile)\r\n    props.uploadMuti(newFile)\r\n  }\r\n\r\n  const renderFile = source => {\r\n    return(\r\n    <React.Fragment>\r\n      {source.map((photo, index) => {\r\n        if(photo.post_images_Type){\r\n          if(photo.post_images_Type === 'image'){\r\n            return (\r\n                <div className=\"list-preview-item\" key={index}>\r\n                  <img src={photo.post_images_Url} />\r\n                  <div className={\"list-preview-item-presential \"+index}><AiOutlineClose onClick={() => deleteFile(index)}/></div>\r\n                </div>\r\n            )\r\n            }else {\r\n              return (\r\n                <div className=\"list-preview-item video-item\" key={index}>\r\n                  <video>\r\n                       <source src={photo.post_images_Url} />\r\n                       Your browser does not support HTML5 video.\r\n                  </video>\r\n                  <div className={\"list-preview-item-presential \"+index}><AiOutlineClose onClick={() => deleteFile(index)}/></div>\r\n                </div>\r\n              )\r\n            }\r\n        }else {\r\n          if(photo.resource_type === 'image'){\r\n            return (\r\n                <div className=\"list-preview-item\" key={index}>\r\n                  <img src={photo.secure_url} />\r\n                  <div className={\"list-preview-item-presential \"+index}><AiOutlineClose onClick={() => deleteFile(index)}/></div>\r\n                </div>\r\n            )\r\n            }else {\r\n              return (\r\n                <div className=\"list-preview-item video-item\" key={index}>\r\n                  <video>\r\n                       <source src={photo.secure_url} />\r\n                       Your browser does not support HTML5 video.\r\n                  </video>\r\n                  <div className={\"list-preview-item-presential \"+index}><AiOutlineClose onClick={() => deleteFile(index)}/></div>\r\n                </div>\r\n              )\r\n            }\r\n        }\r\n      })}\r\n      {loading ? <>\r\n        {listLoading.map((load, index) => {\r\n          return(\r\n            <div className=\"list-preview-next-item\" key={index}>\r\n              <Spin />\r\n            </div>\r\n          )\r\n        })}\r\n      </> : null}\r\n      <div className=\"list-preview-next-item\" >\r\n        <label htmlFor=\"update_post_upload_image\"><FiPlus/></label>\r\n      </div>\r\n    </React.Fragment>\r\n    )\r\n  }\r\n\r\n  return(\r\n    <div className=\"list-preview-container\">\r\n      <div className=\"list-preview-wrap\">\r\n        <div className=\"list-preview\" >\r\n          {renderFile(files)}\r\n        </div>\r\n      </div>\r\n        <input id=\"update_post_upload_image\" type=\"file\" multiple onChange={onChange} accept=\"image/*,video/*\"/>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default UploadMuti;\r\n"]},"metadata":{},"sourceType":"module"}