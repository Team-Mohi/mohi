{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Web\\\\mohi\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import Login from'./../app/Authen/Login.jsx';import axios from'axios';import{API_LOGIN}from'./../Constants/Api.jsx';import{useHistory}from'react-router-dom';import{Route}from'react-router-dom';import{useDispatch}from'react-redux';import{toggleStatusSpin}from'./../Actions/index.jsx';var CryptoJS=require(\"crypto-js\");export default function LoginContainer(props){var dispatch=useDispatch();var history=useHistory();var _useState=useState(),_useState2=_slicedToArray(_useState,2),errorLogin=_useState2[0],setErrorLogin=_useState2[1];var setLoginFunc=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://load Spin\ndispatch(toggleStatusSpin());//check credentials\n_context.next=3;return axios.post('https://www.api.mohi.vn/api/auth/login',data).then(function(res){props.setLoginFunc(res);history.push('/');}).catch(function(err){//if unveri send otp to email or phone when register\nif(err&&err.response.status===301){var user_email=JSON.parse(err.response.config.data).user_email;var user_password=JSON.parse(err.response.config.data).user_password;axios.post('https://www.api.mohi.vn/api/resend-otp',{action:'register',user_email:user_email}).then(function(response){console.log(response);var code=CryptoJS.AES.encrypt(JSON.stringify(response.data.veriCode),'code_veri').toString();history.push('/register/step-2',{user_email:user_email,code:code,id_user:err.response.data.idUser,user_password:user_password});}).catch(function(error){setErrorLogin('Đã có lỗi không mong muốn xảy ra, vui lòng đăng nhập lại');history.push('/login');});}//if uncredentials redirect to login fail\nif(err.response.status===401){setErrorLogin(err.response?err.response.data:'');history.push('/login');}});case 3://close Spin\ndispatch(toggleStatusSpin());case 4:case\"end\":return _context.stop();}}},_callee);}));return function setLoginFunc(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Login,{setLoginFunc:setLoginFunc,errorLogin:errorLogin});}","map":{"version":3,"sources":["D:/Web/mohi/client/src/Containers/LoginContainer.jsx"],"names":["React","useState","Login","axios","API_LOGIN","useHistory","Route","useDispatch","toggleStatusSpin","CryptoJS","require","LoginContainer","props","dispatch","history","errorLogin","setErrorLogin","setLoginFunc","data","post","then","res","push","catch","err","response","status","user_email","JSON","parse","config","user_password","action","console","log","code","AES","encrypt","stringify","veriCode","toString","id_user","idUser","error"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport Login from './../app/Authen/Login.jsx';\r\nimport axios from 'axios';\r\nimport {API_LOGIN} from './../Constants/Api.jsx';\r\nimport {useHistory} from 'react-router-dom';\r\nimport {Route} from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { toggleStatusSpin } from './../Actions/index.jsx';\r\nvar CryptoJS = require(\"crypto-js\");\r\n\r\nexport default function LoginContainer(props){\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const [errorLogin, setErrorLogin] = useState();\r\n\r\n  const setLoginFunc = async (data) => {\r\n    //load Spin\r\n    dispatch(toggleStatusSpin())\r\n\r\n    //check credentials\r\n    await axios.post('https://www.api.mohi.vn/api/auth/login', data).then((res) => {\r\n      props.setLoginFunc(res)\r\n      history.push('/')\r\n    }).catch((err) => {\r\n        //if unveri send otp to email or phone when register\r\n        if(err && err.response.status === 301){\r\n\r\n          let user_email = JSON.parse(err.response.config.data).user_email;\r\n          let user_password = JSON.parse(err.response.config.data).user_password;\r\n\r\n          axios.post('https://www.api.mohi.vn/api/resend-otp', {\r\n            action: 'register',\r\n            user_email: user_email\r\n          }).then((response) => {\r\n            console.log(response);\r\n            let code = CryptoJS.AES.encrypt(JSON.stringify(response.data.veriCode), 'code_veri').toString();\r\n            history.push('/register/step-2', {\r\n              user_email: user_email,\r\n              code: code,\r\n              id_user: err.response.data.idUser,\r\n              user_password: user_password\r\n            });\r\n          }).catch((error) => {\r\n            setErrorLogin('Đã có lỗi không mong muốn xảy ra, vui lòng đăng nhập lại')\r\n            history.push('/login')\r\n          })\r\n\r\n        }\r\n\r\n        //if uncredentials redirect to login fail\r\n        if(err.response.status === 401){\r\n          setErrorLogin(err.response ? err.response.data : '')\r\n          history.push('/login')\r\n        }\r\n\r\n    });\r\n    //close Spin\r\n    dispatch(toggleStatusSpin())\r\n  }\r\n\r\n\r\n  return(\r\n      <Login setLoginFunc={setLoginFunc} errorLogin={errorLogin} />\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}